 glob["debug"] = 1; glob["btn_action"] = new Array(); glob["nick"] = new Array(); glob["balance"] = new Array(); glob["modal_hartbeat"] = 0; glob["page_hartbeat"] = 0; glob["access_balance"] = new Array(); glob["tarif_addr_list"] = new Array(); glob["tarif_addr_list2"] = new Array(); glob["tarif_addr_list2"]["matic"] = new Array(); glob["tarif_addr_list2"]["bsc"] = new Array(); glob["tarif_addr_list2"]["eth"] = new Array(); glob["circle_net"] = "matic"; glob["circle_net"] = "eth"; glob["gov_net"] = "matic"; glob["governance"] = new Array(); glob["factory3_net"] = "eth"; glob["ah_ref_addr"] = "0xC238979895F6A83FF9c0f5Be51664c161D4B576C"; var chainId = 0; var signer2; var provider; var ethereumClient; var WagmiCore; glob["api-dap"] = "https://api-dap.airdrop-hunter.site/"; function log(txt) { if(glob["debug"]) { console.log("LOG: "+txt); } } var selectedAccount = ""; var web3modal; async function set_web3modal(v) { web3modal = v; } function init() { console.log("init"); } async function fetchAccountData(prov) { console.log("fetchAccountData"); switch(prov) { case "metamask": break; } } async function refreshAccountData() { console.log("refreshAccountData"); } async function onConnect(onload=false) { var prov_last = localStorage.getItem("web3_prov"); var last = get_cookie("selectedAccount"); log("onConnect"); if(selectedAccount !== "" && selectedAccount !== undefined) { log("BBBBBBBBBBBBBBBB "+selectedAccount); auth_on_off(1); } else { log("Cached address: "+last); if(last != "") { log("PROV: "+prov_last); switch(prov_last) { case "metamask": connectMetaMask(); break; case "okx": connectOkxWallet(); break; case "c98": connectCoin98Wallet(); break; case "wallet_connect_v2": if (!onload) { localStorage.removeItem("wc@2:core:0.3//messages"); localStorage.removeItem("wc@2:core:0.3//history"); web3modal.openModal(); } break; default: open_modal_connect(); } } else log("last selectedAccount has value: "+last); auth_on_off(0); } } async function onDisconnect() { console.log("onDisconnect"); selectedAccount = ""; set_cookie("selectedAccount",""); localStorage.setItem("web3_prov",""); auth_on_off(0); glob["onConnected"] = 0; await WagmiCore.disconnect(); return false; } async function change_chain(c) { log("change_chain"); var v = 0; var name = ""; var logo_name = ""; switch(c) { case "bsc": v = "0x38"; name = "BSC"; logo_name = "bsc.svg"; break; case "eth": v = "0x1"; name = "Ethereum Mainnet"; logo_name = "eth.svg"; break; case "matic": v = "0x89"; name = "Polygon Mainnet"; logo_name = "polygon.svg"; break; case "fork": v = "0x7A69"; name = "Custom Fork"; logo_name = "eth.svg"; break; case "mumbai": v = "0x13881"; name = "Polygon Mumbai"; logo_name = "polygon.svg"; break; case "goerli": v = "0x5"; name = "Ethereum Goerli"; logo_name = "goerli.svg"; break; case "arbitrum": v = "0xa4b1"; name = "Arbitrum"; logo_name = "arbitrum-logo.svg"; break; case "arbitrum_nova": v = "0xa4ba"; name = "Arbitrum Nova"; logo_name = "arbitrum-nova-logo.png"; break; case "avalanche": v = "0xa86a"; name = "Avalanche"; logo_name = "avax.svg"; break; case "optimism": v = "0xa"; name = "Optimism Mainnet"; logo_name = "optimism.svg"; break; case "polygon_zkevm": v = "0x44d"; name = "Polygon zkEVM"; logo_name = "polygon-zkevm-logo.png"; break; case "zksync": v = "0x144"; name = "zkSync Era Mainnet"; logo_name = "zksync_arrow2.png"; break; } var prov_now = get_web3_prov(); var prov_type1 = prov_type(prov_now); var network_params = [{ "0x38": { rpcUrls: ['https://rpc.ankr.com/bsc'], nativeCurrency: {name: 'BNB', symbol: 'BNB', decimal: 18}, } }]; switch(prov_type1) { case "wc":  web3modal.openModal({route: 'SelectNetwork'}); break; default: try { await ethereum.request({ method: 'wallet_switchEthereumChain', params: [{ chainId: v }], }); } catch (error) { if (error.code == 4902) { } } } return false; } var web3mas = new Array(); web3mas["matic"] = new Web3("https://rpc.airdrop-hunter.site/polygon"); web3mas["bsc"] = new Web3("https://rpc.airdrop-hunter.site/bsc"); web3mas["eth"] = new Web3("https://rpc.airdrop-hunter.site/eth"); web3mas["fork"] = new Web3("https://rpc.airdrop-hunter.site/fork"); web3mas["mumbai"] = new Web3("https://rpc.airdrop-hunter.site/mumbai"); function explorer_url(name) { var explorer = ''; switch(name) { case "eth": explorer = 'https://etherscan.io/'; break; case "bsc": explorer = 'https://bscscan.com/'; break; case "matic": explorer = 'https://polygonscan.com/'; break; case "mumbai": explorer = 'https://mumbai.polygonscan.com/'; break; default: explorer = 'https://polygonscan.com/tx/'; } return explorer; } glob["screenshot"] = ""; function screenshots() { const screenshotTarget = document.body; var a = html2canvas(screenshotTarget); console.log(a); } function pushScreenshotToServer(dataURL) { $.ajax({ url: glob["api-dap"]+"support/", type: "POST", data: { image: dataURL }, dataType: "html", success: function() { console.log('Screenshot pushed to server.'); } }); } hotkeys('alt+s', function(event, handler) { console.log("ALT + s pressed"); support_click(); }); hotkeys('alt+r', function(event, handler) { console.log("ALT + r pressed"); location.href = "/"; }); function connect_wallet_add_onclick() { var x = ''; var y = ''; var l = 0; x = document.getElementsByClassName('wallet_connect'); l = x.length; for(i = 0;i<l;i++) { y = x[i]; y.addEventListener("click",function(){return open_modal_connect()}); } } connect_wallet_add_onclick(); function connect_wal() { console.log("connect_wal clicked"); onConnect(); return false; } async function sign_msg() { const exampleMessage = 'Example `personal_sign` message.'; try { const from = selectedAccount; const msg = " "+from; const sign = await ethereum.request({ method: 'personal_sign', params: [msg, from, 'Example password'], }); console.log(sign); console.log("'"+msg+"'"); } catch (err) { console.error(err); } } function auth_on_off(on) { var i; var x = document.getElementsByClassName("auth_off"); l = x.length; if(l>0) for(i=0;i<l;i++) { if(on) x[i].classList.remove("d-none"); else x[i].classList.add("d-none"); } var x = document.getElementsByClassName("auth_on"); l = x.length; if(l>0) for(i=0;i<l;i++) { if(on) x[i].classList.add("d-none"); else x[i].classList.remove("d-none"); } } $( document ).ready(function() { init(); var t = get_cookie("selectedAccount"); if(t != undefined && t.length==42) onConnect(true); check_extension_installed(); }); function getData(requestURL,func) { const xhr = new XMLHttpRequest(); xhr.open('GET', requestURL); xhr.onload = () => { if (xhr.status !== 200) { return; } eval(func); }; xhr.send(); } function wallet_id_set(wal) { var x = ''; var y = ''; var l = 0; var w = wal_3dot(wal); log("WALLET_id_SET: '"+w+"'"); x = document.getElementsByClassName('wallet-id'); l = x.length; for(i = 0;i<l;i++) { y = x[i]; y.innerHTML = w; } x = document.getElementsByClassName('wallet-id-full'); l = x.length; for(i = 0;i<l;i++) { y = x[i]; y.innerHTML = wal; } } function wal_3dot(wal) { var t = ''; if(wal === undefined)return; if(wal.length > 2) { t = wal.substring(0,5); t += '...'; t += wal.substring(38); } return t; } function ajax_get_data(requestURL,func) { const xhr = new XMLHttpRequest(); xhr.open('GET', requestURL); xhr.onload = () => { if (xhr.status !== 200) { return; }; eval(func); }; xhr.send(); } function ajax_post_data(requestURL,params,func) { const xhr = new XMLHttpRequest(); xhr.open('POST', requestURL); xhr.onload = () => { if (xhr.status !== 200) { return; }; eval(func); }; xhr.send(params); } function getCurrentTimestamp() { return Date.now() } function utime_to_localtime(t) { t *= 1000; dateObject = new Date(t); humanDateFormat = dateObject.toLocaleString(); return humanDateFormat; } setInterval(get_version,10000); function get_version() { getData("/version/","check_version(xhr.response)"); } function check_version(data) { if(data != glob["site_version"]) { console.log("Reload page. Version "+data); window.location.reload(); } } setInterval(get_update_time,60000); function get_update_time() { getData("/update_time/","check_update_time(xhr.response)"); } function check_update_time(data) { if(data != glob["update_time"]) { console.log("Reload page. update_time "+data); window.location.reload(); } } function get_function_name(ownName) { ownName = ownName.substr('function '.length); ownName = ownName.substr(0, ownName.indexOf('(')); return ownName; } function change_theme() { var on; var x = document.getElementById('body'); var y = ""; y = x.className; var z = ""; if(y=="dark-theme")	{on=0;z = "";} else {on=1;z = "dark-theme";} x.className = z; localStorage.setItem('theme', z); if(on) document.cookie = "theme=dark"; else document.cookie = "theme="; return false; } function set_theme() { var x = document.getElementById('body'); var y = ""; y = localStorage.getItem('theme'); x.className = y; x = document.getElementById('theme'); if(y=="") x.checked = false; else x.checked = true; } function btn_click_action(e) { var a = ""; if(glob["btn_action"][e.id] !== null) a = glob["btn_action"][e.id]; log("btn CLICK:"+e.id +' a:'+a); if(a)eval(a); return false; } function get_cookie(name) { var match = document.cookie.match(new RegExp('(^| )' + name + '=([^;]+)')); if (match) return match[2]; } function set_cookie(name,value) { var date = new Date(),expires = 'expires='; date.setTime(date.getTime() + 315360000000); expires += date.toGMTString(); document.cookie = name + '=' + value + '; ' + expires + '; path=/'; } function inviter_show() { var err; var t; var url; var n = get_cookie("ref_nick"); var a = get_cookie("ref_wal"); url = explorer_url("matic"); url += "address/"+a; err = 0; if(!err && a === undefined) { err = 1; t = "No inviter yet"; } if (!err) { if(n !== undefined) { t = "<a href="https://app.airdrop-hunter.site/js2/\&quot;&quot;+url+&quot;\&quot;" target=blank>"+n+"</a>"; } else { t = "<a href="https://app.airdrop-hunter.site/js2/\&quot;&quot;+url+&quot;\&quot;" target=blank>"+wal_3dot(a)+"</a>"; } } var x; var y; var i; var l; y = document.getElementsByClassName("inviter"); l = y.length; for(i=0;i<l;i++) { x = y[i]; if(x.innerHTML != t) x.innerHTML = t; } } setInterval(inviter_show,1000); function onload_switch_item() { switch(glob["item"]) { case "gov": case "governance": setInterval(func_page_governance,300); break; case "inviters": setInterval(func_page_inviters,300); break; case "ref": setInterval(func_page_ref,300); break; case "get100": setInterval(func_page_get100,300); break; } } setTimeout(onload_switch_item,500); function validate_email(email) { return email.toLowerCase().match(/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/); } function validateEmail(email) { const regex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/; return regex.test(email); } function is_mobile_device() { const userAgent = navigator.userAgent || navigator.vendor || window.opera; return /android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(userAgent.toLowerCase()); } function open_modal_connect() { $('#buyTarifModal').modal('hide'); if (is_mobile_device()) { connect_v2_wal("wallet_connect_v2"); return; } console.log("open_modal_connect"); $('#modal_auth').modal('show'); } async function connect_v2_wal(k) { var x; var img; var m = new Array(); var txt; var title; var name; var url; var t; var close_time = 1000; console.log("K: "+k); glob["modal_txs_link"] = ""; switch(k) { case "okx": img = "<div class=\"d-flex\"><img src="https://app.airdrop-hunter.site/images/okx4.svg?1" class=\"logo\"> "; m["title"] = "Connect Okx wallet"; if (!window.okxwallet) { txt = img+"<div>Download in the Chrome Web Store</div></div>"; url = "https://chrome.google.com/webstore/detail/okx-wallet/mcohilncbfahbmgdjkbpemcciiolgcge"; glob["modal_txs_link"] = url; m["btn"] = "Install chrome extension["+k+"]"; m["btn_enable"] = 1; } else { connectOkxWallet(); txt = img+"<div>Confirm connection in OKX wallet</div></div>"; m["btn"] = "See you Okx Wallet"; } modal_tx_info_open(txt,m); $('#modal_auth').modal('hide'); break; case "metamask": img = "<div class=\"d-flex\"><img src="../images/metamask.svg" class=\"logo\"> "; m["title"] = "Connect Metamask wallet"; if (!window.ethereum) { txt = img+"<div>Download in the Chrome Web Store</div></div>"; url = "https://chrome.google.com/webstore/detail/metamask/nkbihfbeogaeaoehlefnkodbefgpgknn"; glob["modal_txs_link"] = url; m["btn"] = "Install chrome extension["+k+"]"; m["btn_enable"] = 1; } else { connectMetaMask(); txt = img+"<div>Confirm connection in Metamask wallet</div></div>"; m["btn"] = "See you Metamask Wallet"; } modal_tx_info_open(txt,m); $('#modal_auth').modal('hide'); break; case "coin98": img = "<div class=\"d-flex\"><img src="../images/c98.svg" class=\"logo\"> "; m["title"] = "Connect C98 wallet"; if (!window.coin98) { txt = img+"<div>Download in the Chrome Web Store</div></div>"; url = "https://chrome.google.com/webstore/detail/coin98-wallet/aeachknmefphepccionboohckonoeemg"; glob["modal_txs_link"] = url; m["btn"] = "Install chrome extension["+k+"]"; m["btn_enable"] = 1; } else { connectCoin98Wallet(); txt = img+"<div>Confirm connection in C98 wallet</div></div>"; m["btn"] = "See you C98 Wallet"; } modal_tx_info_open(txt,m); $('#modal_auth').modal('hide'); break; case "wallet_connect_v2": localStorage.removeItem("wc@2:core:0.3//messages"); localStorage.removeItem("wc@2:core:0.3//history"); web3modal.openModal(); $('#modal_auth').modal('hide'); localStorage.setItem("web3_prov", k); log("We are connected: "+k); break; } } async function connectMetaMask() { if (window.ethereum) { try { const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' }); set_selectedAccount(accounts[0]); localStorage.setItem("web3_prov","metamask"); provider = window.ethereum; log("signer2"); console.log(signer2); log('MetaMask connected'); modal_txs_close_timeout(); } catch (error) { if (error.code === 4001) { log('User cancel metamask connect'); } else { log('Metamask connect error:', error.message); } } } else { console.error('MetaMask extension not found'); } } async function connectOkxWallet() { if (window.okxwallet) { try { await window.okxwallet.enable(); const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' }); set_selectedAccount(accounts[0]); localStorage.setItem("web3_prov","okx"); provider = window.okxwallet; log('OkxWallet connected'); modal_txs_close_timeout(); } catch (error) { if (error.code === 4001) { log('User cancel okx connect'); } else { log('Okx connect error:', error.message); } } } else { console.error('OkxWallet extension not found'); } } async function connectCoin98Wallet() { if (window.coin98) { try { const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' }); set_selectedAccount(accounts[0]); localStorage.setItem("web3_prov","c98"); provider = window.ethereum; log('Coin98 connected'); modal_txs_close_timeout(); } catch (error) { if (error.code === 4001) { log('User cancel okx connect'); } else { log('Coin98 connect error:', error.message); } } } else { console.error('Coin98 extension not found'); } } function show_prov() { var prov_now = get_web3_prov(); log("prov_now: "+prov_now); } async function check_extension_installed() { log("check_extension_installed: "+name); var k; var x; window.ethereum.on("accountsChanged", (accounts) => { set_selectedAccount(accounts[0]); modal_txs_close_timeout(); }); log("XXXXXXXXXXXXX "); window.ethereum.on("chainChanged", (this_chainId) => { log("Legacy chain changed: "+this_chainId); set_selected_chain_id(this_chainId); }); k = "okx"; x = document.getElementById("connect_"+k); if (window.okxwallet) { log("wallet "+k+" ok"); x.classList.remove("gray"); } else { log(k+" not installed"); x.classList.add("gray"); } k = "coin98"; x = document.getElementById("connect_"+k); if (window.coin98) { log("wallet "+k+" ok"); x.classList.remove("gray"); } else { log(k+" not installed"); x.classList.add("gray"); } k = "metamask"; x = document.getElementById("connect_"+k); if (window.ethereum && window.ethereum.isMetaMask) { log("wallet "+k+" installed ok"); x.classList.remove("gray"); } else { log(k+" not installed"); x.classList.add("gray"); } } async function set_selectedAccount(addr,prov_name="") { var prov_type1; var prov_type2; var t2; var prov_now = get_web3_prov(); prov_type1 = prov_type(prov_now); prov_type2 = prov_type(prov_name); if(prov_type1 != prov_type2)return false; { if(addr === undefined)addr = ""; selectedAccount = addr; set_cookie("selectedAccount",selectedAccount); if(selectedAccount !== "" && selectedAccount !== undefined) { wallet_id_set(selectedAccount); check_white_list(); glob["onConnected"] = 1; log(signer2); switch(prov_type1) { case "legacy": t2 = await get_chain_id_legacy(); set_selected_chain_id(t2); break; } on_success_connect(); } auth_on_off(selectedAccount?1:0); set_wallet_img(); } } function show_cookie_acc() { var t = get_cookie("selectedAccount"); log("selectedAccount: "+t); } function set_net_img(net) { var n; var x; var img; switch(net) { case 137: img = "<img src="../images/polygon.svg">"; break; case 56: img = "<img src="../images/bsc.svg">"; break; case 1: img = "<img src="../images/eth.svg">"; break; case 42161: img = "<img src="https://app.airdrop-hunter.site/images/arbitrum.png">"; break; case 42170: img = "<img src="https://app.airdrop-hunter.site/images/arb_nova.png">"; break; case 324: img = "<img src="../images/zksync_arrow2.png">"; break; case 1101: img = "<img src="../images/polygon-zkevm-logo.png">"; break; case 43114: img = "<img src="../images/avax.svg">"; break; case 10: img = "<img src="../images/optimism.svg">"; break; default: img = "<img src="../images/change_network24.png" title=\"Unsupported network\">"; } n = 'wallet-net'; set_by_className(n,img); } function set_wallet_img() { var n; var x; var img; var prov = localStorage.getItem("web3_prov"); log("IMG prov: "+prov); switch(prov) { case "metamask": img = "<img src="../images/mm.svg">"; break; case "okx": img = "<img src="https://app.airdrop-hunter.site/images/okx4.svg">"; break; case "c98": img = "<img src="../images/c98.svg">"; break; case "wc": case "wallet_connect_v2": img = "<img src="../images/wc2.svg">"; break; } n = 'wallet-logo'; set_by_className(n,img); } function getEthersProvider({ chainId }) { const publicClient = WagmiCore.getPublicClient({ chainId }); return publicClientToProvider(publicClient); } function publicClientToProvider(publicClient) { const { chain, transport } = publicClient; const network = { chainId: chain.id, name: chain.name, ensAddress: chain.contracts?.ensRegistry?.address, }; if (transport.type === 'fallback') return new ethers.providers.FallbackProvider( (transport.transports).map( ({ value }) => new ethers.providers.JsonRpcProvider(value?.url, network) ) ); return new ethers.providers.JsonRpcProvider(transport.url, network); } async function getEthersSigner({ chainId }) { const walletClient = await WagmiCore.getWalletClient({ chainId }); if (!walletClient) return undefined; return walletClientToSigner(walletClient); } function walletClientToSigner(walletClient) { const { account, chain, transport } = walletClient; const network = { chainId: chain.id, name: chain.name, ensAddress: chain.contracts?.ensRegistry?.address, }; const provider = new ethers.providers.Web3Provider(transport, network); const signer = provider.getSigner(account.address); return signer; } async function get_signer2() { var prov_now = get_web3_prov(); var prov_type1 = prov_type(prov_now); var signer2; var provier2; if (prov_type1 == "wc") { provider2 = await getEthersProvider({chainId}); signer2 = await getEthersSigner({ chainId }); if (!signer2) { console.error('Wallet provider not connected'); return; } } else { provider2 = new ethers.providers.Web3Provider(provider); signer2 = provider2.getSigner(); } return signer2; } async function show_signer() { console.log("show signer2"); var signer2 = await get_signer2(); console.log(signer2); } function set_selected_chain_id(id) { id = get_chain_hexdec(id); chainId = id; log("chain id set now: "+id); set_net_img(id); } function get_chain_hexdec(id) { var t; var l = id.length; if(l>=2) { t = id.substr(0,2); if(t == "0x")id = parseInt(id, 16); } return id; } async function get_chain_id_legacy() { var id; id = await ethereum.request({ method: 'eth_chainId' }); id = get_chain_hexdec(id); log("get_chain_id_legacy: "+id); return id; } function prov_type(prov) { switch(prov) { case "wallet_connect_v2": case "wallet_connect": r = "wc"; break; default: r = "legacy"; } return r; } function whoCallsMe() { stack = (new Error).stack; console.log('stack', stack); } function whoCallsMe2() { s = (new Error).stack; var t; t = s.indexOf("\n"); s = s.substr(t+1); t = s.indexOf("\n"); s = s.substr(t+1); t = s.indexOf("\n"); s = s.substr(0,t); s = s.trim(); t = s.indexOf("at "); s = s.substr(t+3); t = s.indexOf(" "); s = s.substr(0,t); s = s.trim(); return s; } function modal_txs_close_timeout() { setTimeout(modal_txs_close_timeout2,50); } function modal_txs_close_timeout2() { $('#modal_tx_info').modal('hide'); } function get_web3_prov() { var prov_now = localStorage.getItem("web3_prov"); return prov_now; } function modal_ref_open() { var txt; var x; console.log(selectedAccount); if(selectedAccount == null) { onConnect(); } else { x = document.getElementById("modal_refferal_link"); txt = glob["domen"]+"ref/?"+selectedAccount; x.value = txt; $('#modal_refferal').modal('show'); $('#accountModal').modal('hide'); } } function ref_copy1(e,xid) { var l; var id = e.id; var x; var txt; x = document.getElementById(xid); txt = x.value; l = txt.length; x.focus(); x.setSelectionRange(0,l); try { succeed = document.execCommand("copy"); } catch(e) { succeed = false; } var x = document.getElementById(id); x.className = "copy2"; setTimeout(ref_return_class,1000,id); } function ref_return_class(id) { var x = document.getElementById(id); x.className = "copy"; } glob["modal_last"] = ""; function found_and_check_open_modal() { var x; var y = document.getElementsByClassName("modal"); var l = y.length; var i; for(i=0;i<l;i++) { x = y[i]; if(glob["modal_last"] == x.id && x.className != "modal fade show") { console.log('Closed modal: '+x.id); glob["modal_last"] = ""; glob["modal_hartbeat"] = 0; } if(x.className == "modal fade show") { if(glob["modal_last"] != x.id) { console.log('Opened modal: '+x.id); glob["modal_last"] = x.id; } } } } setInterval(found_and_check_open_modal,500); function modal_action_on_open_state() { var s = ""; var f = ""; var ev = ""; switch(glob["modal_last"]) { default: if(glob["modal_last"] != "") { ev = ""; f = "func_"+glob["modal_last"]+""; s = "typeof "+f; if (eval(s) === 'function') { ev = f+"();"; eval(ev); } } } } setInterval(modal_action_on_open_state,300); glob["func_modal_refferal"] = 0; function func_modal_refferal() { var x; var v; if(glob["nick"][selectedAccount] === undefined) glob["nick"][selectedAccount] = ""; } function func_buyModal() { btn_access_buy("matic","usdc"); btn_access_buy("matic","usdt"); btn_access_buy("matic","dai"); btn_access_buy("bsc","usdc"); btn_access_buy("bsc","usdt"); btn_access_buy("bsc","dai"); btn_access_buy("eth","usdc"); btn_access_buy("eth","usdt"); btn_access_buy("eth","dai"); glob["modal_hartbeat"]++; if(glob["modal_hartbeat"]==1) { web3_access_balance_allowance("bsc"); web3_access_balance_allowance("matic"); web3_access_balance_allowance("eth"); } if(glob["modal_hartbeat"] >= 18) glob["modal_hartbeat"] = 0; } function func_buyTarifModal() { btn_tarif_buy("matic"); btn_tarif_buy("bsc"); glob["modal_hartbeat"]++; if(glob["modal_hartbeat"]==1) { } if(glob["modal_hartbeat"] >= 18) glob["modal_hartbeat"] = 0; } function func_modal_circle() { var id; var i; var x; var l; var y; var v; var flag; x = document.getElementById('modal_circle_tarif_id'); id = x.innerHTML*1; if(glob["tarif_addr_list"][id] === undefined) { flag = 0; } else { if(glob["tarif_addr_list"][id])flag = 1; else flag = 0; } modal_circle_button_show(flag); btn_circle_1_2(); btn_circle_2_2(); btn_circle_3_2(); btn_circle_4_2(); btn_circle_4_5(); btn_circle_5_2(); btn_circle_7_2(); btn_circle_10_2(); btn_circle_12_2(); } function modal_circle_button_show(flag) { var need_download = 0; var i; var x; var y; var l; y = document.getElementsByClassName("circle_tarif_true"); l = y.length; for(i=0;i<l;i++) { x = y[i]; if(flag) { if(x.classList.contains("d-none")) { x.classList.remove("d-none"); need_download ++; } } else { if(!x.classList.contains("d-none")) x.classList.add("d-none"); } } if(need_download) { console.log("Need load addresses"); web3_factory_status(); x = document.getElementById('modal_circle_tarif_id'); i = x.innerHTML*1; wallet_list(selectedAccount,i); } y = document.getElementsByClassName("circle_tarif_false"); l = y.length; for(i=0;i<l;i++) { x = y[i]; if(!flag) { if(x.classList.contains("d-none")) x.classList.remove("d-none"); } else { if(!x.classList.contains("d-none")) x.classList.add("d-none"); } } } function func_buy_refill_modal() { btn_refill_buy("matic","usdc"); btn_refill_buy("matic","usdt"); btn_refill_buy("matic","dai"); btn_refill_buy("bsc","usdc"); btn_refill_buy("bsc","usdt"); btn_refill_buy("bsc","dai");  glob["modal_hartbeat"]++; if(glob["modal_hartbeat"]==1) { web3_refill2_CheckBalanceAllowance("matic"); web3_refill2_CheckBalanceAllowance("bsc"); } if(glob["modal_hartbeat"] >= 18) glob["modal_hartbeat"] = 0; } function func_modal_governance() { btn_gov(); glob["modal_hartbeat"]++; if(glob["modal_hartbeat"]==1) { web3_gov_balance(); } if(glob["modal_hartbeat"] >= 18) glob["modal_hartbeat"] = 0; } function func_page_governance() { glob["page_hartbeat"]++; if(glob["page_hartbeat"]==1) { web3_gov_is_admin(); web3_gov_update_time(); } if(glob["page_hartbeat"] >= 18) glob["page_hartbeat"] = 0; } function func_page_inviters() { glob["page_hartbeat"]++; if(glob["page_hartbeat"]==1) { web3_ref_balance_update_time("bsc"); web3_ref_balance_update_time("matic"); } if(glob["page_hartbeat"] >= 18) glob["page_hartbeat"] = 0; } function func_page_ref() { glob["page_hartbeat"]++; if(glob["page_hartbeat"]==1) { console.log("Get ref"); } btn_ref_claim20(); if(glob["page_hartbeat"] >= 18) glob["page_hartbeat"] = 0; } function tg_button() { var x = document.getElementById('tg-field'); x.classList.remove('d-none'); x = document.getElementById('email-field'); x.classList.add('d-none'); x = document.getElementById('bookmark-text'); x.classList.add('d-none'); x = document.getElementById('copy-text'); x.classList.add('d-none'); x = document.getElementById('homescreen-text'); x.classList.add('d-none'); } function tg_link() { var x = document.getElementById('inviter_refferal_link_block'); x.classList.remove('d-none'); var s = document.getElementById('inviter_refferal_link'); var v = s.value; x.classList.add('d-none'); window.open('https://t.me/airdrop_hunter_site_bot?start=' + v.split('?')[1], '_blank'); } function copy_button() { var x = document.getElementById('inviter_refferal_link_block'); x.classList.remove('d-none'); ref_copy1(document.getElementById('temp_div'), 'inviter_refferal_link'); x.classList.add('d-none'); x = document.getElementById('copy-text'); x.classList.remove('d-none'); x = document.getElementById('bookmark-text'); x.classList.add('d-none'); x = document.getElementById('email-field'); x.classList.add('d-none'); x = document.getElementById('tg-field'); x.classList.add('d-none'); x = document.getElementById('homescreen-text'); x.classList.add('d-none'); } function email_button() { var x = document.getElementById('email-field'); x.classList.remove('d-none'); x = document.getElementById('bookmark-text'); x.classList.add('d-none'); x = document.getElementById('copy-text'); x.classList.add('d-none'); x = document.getElementById('tg-field'); x.classList.add('d-none'); x = document.getElementById('homescreen-text'); x.classList.add('d-none'); } function email_submit_button() { email_input = document.getElementById('email-input-field'); var is_email_valid = validateEmail(email_input.value); console.log('IS VALID EMAIL ' + is_email_valid); if (!is_email_valid) { email_ref_info = document.getElementById('email_ref_info'); email_ref_info.textContent = 'Wrong email'; setTimeout(email_textContent_hide,1000); return false; } inviter_refferal_link = document.getElementById('inviter_refferal_link'); $.ajax ({ url: glob['domen']+'email_ref_link', type: 'POST', data: { email: email_input.value, referral_link: inviter_refferal_link.value, }, success: function(msg) { email_txt = document.getElementById('email-txt'); email_txt.classList.add('blue-text'); email_txt.innerHTML = "We sent the referral link to your email.<br>Check your email box!<br><br>"; email_input_block = document.getElementById('email-input-field-block'); email_input_block.style.display = 'none'; } }); return false; } function email_textContent_hide() { var x = document.getElementById('email_ref_info'); x.innerHTML = '&nbsp;'; } function bookmark_button() { var x = document.getElementById('bookmark-text'); x.classList.remove('d-none'); x = document.getElementById('email-field'); x.classList.add('d-none'); x = document.getElementById('copy-text'); x.classList.add('d-none'); x = document.getElementById('tg-field'); x.classList.add('d-none'); x = document.getElementById('homescreen-text'); x.classList.add('d-none'); } function homescreen_button() { var x = document.getElementById('homescreen-text'); x.classList.remove('d-none'); x = document.getElementById('bookmark-text'); x.classList.add('d-none'); x = document.getElementById('email-field'); x.classList.add('d-none'); x = document.getElementById('copy-text'); x.classList.add('d-none'); x = document.getElementById('tg-field'); x.classList.add('d-none'); } function modal_tx_info_open(txt = '',m = new Array()) { console.log('FUNC modal_tx_info_open'); var x; var title = m["title"]!==undefined?m["title"]:"Transaction info"; var err = m["err"]!==undefined?m["err"]:""; var btn	= m["btn"]!==undefined?m["btn"]:"See YOUR wallet"; var dis = m["btn_enable"]===undefined?1:0; x = document.getElementById('modal_txs_info_ok'); x.innerHTML = txt; x = document.getElementById('modal_txs_info_err'); x.innerHTML = err; x = document.getElementById('modal_txs_info_id'); x.innerHTML = ''; x = document.getElementById('modal_txs_info_btn'); x.innerHTML = btn; x.disabled = dis; x = document.getElementById('modal_txs_info_title'); x.innerHTML = title; $('#modal_tx_info').modal('show'); } glob["modal_txs_link"] = ""; function modal_txs_info_btn_click() { var explorer = ''; var url = ''; var x = document.getElementById('modal_txs_info_id'); if(x.innerHTML != '') { switch(chainId) { case 1: explorer = 'https://etherscan.io/tx/'; break; case 56: explorer = 'https://bscscan.com/tx/'; break; case 137: explorer = 'https://polygonscan.com/tx/'; break; case 80001: explorer = 'https://mumbai.polygonscan.com/tx/'; break; default: explorer = 'https://polygonscan.com/tx/'; } url = explorer+x.innerHTML; console.log(url); window.open(url, '_blank'); } if(glob["modal_txs_link"] != "") { url = glob["modal_txs_link"]; window.open(url, '_blank'); glob["modal_txs_link"] = ""; x = document.getElementById('modal_txs_info_btn'); x.disabled = 1; } } function check_white_list() { var url = glob["domen"]; if(!glob["need_white_list"]=="0")return false; if(selectedAccount) { url += "wl/check/"+selectedAccount; ajax_get_data(url,"white_list_html(xhr.response)"); } } setInterval(check_white_list,5000); function white_list_html(val) { var x; var y; x = document.getElementById('whitelist_on'); y = document.getElementById('whitelist_off'); if(val == 1) { if(x.className != "") x.className = ""; if(y.className != "d-none") y.className = "d-none"; } else { if(x.className != "d-none") x.className = "d-none"; if(y.className != "") y.className = ""; } } function claim_bonus_add_onclick() { var x = ''; var y = ''; var l = 0; x = document.getElementsByClassName('claim-bonus-button'); l = x.length; for(i = 0;i<l;i++) { y = x[i]; y.addEventListener("click",function(){return open_modal_claim_bonus()}); } } function get100_set_up_page() { set_cookie("get100_twitter_error_type", 0); set_cookie("get100_email_error_type", 0); set_cookie("get100_claimed", ""); var last_page = get_cookie('get100_item'); switch (last_page) { case '1': get100_email_btn(); break; case '2': get100_twitter_btn(); break; case '3': get100_retweet_btn(); break; case '4': get100_tg_btn(); break; } get100_check_connections(); urlString = location.href; let paramString = urlString.split('?')[1]; if (!paramString) { return false; } let params_arr = paramString.split('&'); for (let i = 0; i < params_arr.length; i++) { let pair = params_arr[i].split('='); if (pair[0] == 'step') { switch(pair[1]) { case "twitter": get100_twitter_btn(); get100_update_twitter_field(true); break; case "twitter_duplicate": set_cookie("get100_twitter_error_type", 1); get100_twitter_btn(); get100_update_twitter_field(false); break; case "email": get100_email_btn(); get100_update_email_field(true); break; case "email_duplicate": set_cookie("get100_email_error_type", 1); get100_email_btn(); get100_update_email_field(false); break; case "tg": get100_tg_btn(); break; } } } } if(glob["item"]=="get100") get100_set_up_page(); function func_page_get100() { glob["page_hartbeat"]++; if(glob["page_hartbeat"]==1) { web3_ref_claim_get100_ClamedByWal(); } btn_ref_claim100(); if(glob["page_hartbeat"] >= 50) glob["page_hartbeat"] = 0; } function get100_check_connections() { var twitter_connected = false; var email_connected = false; var retweeted = false; var followed = false; var tg_connected = false; var twitter_code = localStorage.getItem('get100_twr'); var email_code = localStorage.getItem('get100_eml'); var tg_code = localStorage.getItem('get100_tlg'); var twitter_username = ''; var email = ''; var tg_username = ''; $.ajax ({ url: glob['domen'] + 'get100_connections/', type: 'GET', data: { 'twitter_code': twitter_code, 'email_code': email_code, 'tg_code': tg_code, }, success: function(data) { var completed_steps = data['completed_steps']; for (var i in completed_steps) { switch (completed_steps[i]) { case '1': email_connected = true; break; case '2': twitter_connected = true; break; case '3': retweeted = true; break; case '4': tg_connected = true; break; } } if (twitter_connected) { twitter_code = data['twitter_code']; twitter_username = data['twitter_username']; localStorage.setItem('get100_twr', twitter_code); set_cookie("get100_twitter_error_type", 0); } else { localStorage.removeItem('get100_twr'); } if (email_connected) { email_code = data['email_code']; email = data['email']; localStorage.setItem('get100_eml', email_code); set_cookie("get100_email_error_type", 0); } else { localStorage.removeItem('get100_eml'); } if (tg_connected) { tg_code = data['tg_code']; tg_username = data['tg_username']; localStorage.setItem('get100_tlg', tg_code); } if (localStorage.getItem('get100_twr')) { twitter_connected = true; } if (localStorage.getItem('get100_eml')) { email_connected = true; } if (twitter_connected && !retweeted) { get100_check_retweet(); } get100_update_twitter_field(twitter_connected, twitter_username); get100_update_email_field(email_connected, email); get100_update_retweet_field(retweeted); get100_update_tg_field(tg_connected, tg_username); if (twitter_connected && !followed) { get100_check_follow(); } web3_ref_claim_get100_ClamedByWal(); } }); } function get100_wallet_btn() { get100_set_up_d_none('get100-connect-wallet-field'); } var get100_tg_interval; function get100_tg_btn() { get100_set_up_d_none('get100-tg-field'); web3_ref_claim_get100_ClamedByWal(); set_cookie("get100_item", 4); return; $.ajax ({ url: glob['domen'] + 'get100_d2t/', type: 'POST', data: { 'tg_code': localStorage.getItem('get100_tlg'), }, success: function(data) { var tg_connected = data['tg_connected']; var tg_username = data['tg_username']; var tg_code = data['tg_code']; localStorage.setItem('get100_tlg', tg_code); var tg_field = document.getElementById('get100-tg-field'); if (tg_connected) { tg_field.innerHTML = ` <div> Telegram @${tg_username} successfully connected </div> `; } else { tg_field.innerHTML = ` <div> By clicking the button below, you will be redirected to our Telegram bot </div> <div> <button type="submit" class="art-button-3 btn btn-primary btn-sm blk-button" id="get100-tg-link" onclick="">Go to Telegram</button> </div> <div> Click <b>/start</b> in the bot </div> <div id="get100-tg-field-code-txt"></div> `; var tg_link_btn = document.getElementById('get100-tg-link'); tg_link_btn.onclick = function(){return get100_tg_link(tg_code)}; var tg_code_txt = document.getElementById('get100-tg-field-code-txt'); tg_code_txt.textContent = 'Also you can send this code to our bot manually: ' + tg_code; clearInterval(get100_tg_interval); get100_tg_interval = setInterval(get100_check_tg, 5000, tg_code); } } }); } function get100_check_tg(tg_code) { $.ajax ({ url: glob['domen'] + 'get100_d2t/', type: 'GET', data: { tg_code: localStorage.getItem('get100_tlg'), }, success: function(data) { var tg_connected = data['tg_connected']; var tg_username = data['tg_username']; if (tg_connected) { var tg_field = document.getElementById('get100-tg-field'); tg_field.innerHTML = ` <div> Telegram @${tg_username} successfully connected </div> `; clearInterval(get100_tg_interval); get100_check_connections(); } } }); } function get100_update_tg_field(connected=false, username='') { var tg_field = document.getElementById('get100-tg-field'); if (connected) { tg_field.innerHTML = ` <div> Telegram @${username} successfully connected </div> `; } } function get100_twitter_btn() { get100_set_up_d_none('get100-twitter-field'); web3_ref_claim_get100_ClamedByWal(); set_cookie("get100_item", 2); } function get100_update_twitter_field(connected=false, username='') { var twitter_field = document.getElementById('get100-twitter-field'); if (connected) { twitter_field.innerHTML = ` <div class='temp-txt'> <div> Twitter <span class='blue-text'>@${username}</span> successfully connected </div> <div class="error-text" id="get100-follow-error-text">&nbsp;</div> <div id="get100-follow-field"></div> </div> `; } else { twitter_field.innerHTML = ` <div class="temp-txt"> <div> By clicking the button below, you will be redirected to Twitter authorization page </div> <div> <button type="submit" class="art-button-3 btn btn-primary btn-sm blk-button" onclick="get100_twitter_link();">Go to Twitter</button> </div> <div class="error-text" id="get100-twitter-error-text">&nbsp;</div> <div> Followinng to AirdropHunter and get $25! </div> </div> `; } var error_type = get_cookie("get100_twitter_error_type"); if (error_type == 1) { var error_text = document.getElementById('get100-twitter-error-text'); error_text.innerHTML = 'This account already connected to another wallet.&nbsp;Use a different account'; } } function get100_email_btn() { get100_set_up_d_none('get100-email-field'); web3_ref_claim_get100_ClamedByWal(); set_cookie("get100_item", 1); } function get100_update_email_field(connected=false, email='') { var email_field = document.getElementById('get100-email-field'); if (connected) { email_field.innerHTML = ` <div class='temp-txt'> <div> Email <span class='blue-text'>${email}</span> successfully confirmed </div> </div> `; } else { email_field.innerHTML = ` <div class="email-field"> <div class="email-input-field" id="get100-email-input-block"> <input type="text" id="get100-email-input" name="email" class="i link-input email-input" placeholder="Email"/> <button type="submit" id="get100-email-submit-button" class="art-button-3 btn btn-primary btn-sm email-submit-button" onclick="get100_email_submit();">Submit</button> </div> <div class="email-input-txt" id="get100-email-success-txt"> Provide your email and recieve <br>the confirmation code.<br>Follow the link and get $25! </div> <div class="error-text" id="get100-email-error-text">&nbsp;</div> </div> `; } var error_type = get_cookie("get100_email_error_type"); if (error_type == 1) { var error_text = document.getElementById('get100-email-error-text'); error_text.innerHTML = 'This email already connected to another wallet.&nbsp;Use a different email'; } } function get100_check_follow() { $.ajax ({ url: glob['domen'] + 'get100_follow/', type: 'GET', data: { code: localStorage.getItem('get100_twr'), }, success: function(data) { var followed = data['followed']; var status = data['status']; if (status == 404) { var error_text = document.getElementById('get100-follow-error-text'); error_text.innerHTML = 'Twitter not connected.&nbsp;Connect and try again'; setTimeout(get100_return_d_none, 2000, 'get100-follow-error-text'); return; } var follow_field = document.getElementById('get100-follow-field'); if (followed) { follow_field.innerHTML = ` We found your follow.<br>Now you're able to claim $25! `; } else { follow_field.innerHTML = ` <div> <button id="get100-follow-btn" type="submit" class="art-button-3 btn btn-primary btn-sm blk-button" onclick="get100_follow_link();">Follow us</button> </div> <div> Or </div> <div> <button id="get100-check-follow-btn" type="submit" class="art-button-3 btn btn-primary btn-sm blk-button" onclick="get100_check_follow();">Check my follow</button> </div> `; var error_text = document.getElementById('get100-follow-error-text'); error_text.innerHTML = 'Follow not found.&nbsp;Try again after 5 minutes'; setTimeout(get100_return_d_none, 2000, 'get100-follow-error-text'); } }, }); } function get100_retweet_btn() { get100_set_up_d_none('get100-retweet-field'); web3_ref_claim_get100_ClamedByWal(); set_cookie("get100_item", 3); } function get100_check_retweet() { if (!localStorage.getItem('get100_twr')) { var x = document.getElementById('get100-check-retweet-btn'); x.textContent = 'Connect Twitter'; x.onclick = get100_twitter_link; return; } $.ajax ({ url: glob['domen'] + 'get100_retweet', type: 'POST', data: { code: localStorage.getItem('get100_twr'), }, success: function(data) { var retweeted = data['retweeted']; var status = data['status']; if (status == 404) { var error_text = document.getElementById('get100-retweet-error-text'); error_text.innerHTML = 'Twitter not connected.&nbsp;Connect and try again'; setTimeout(get100_return_d_none, 2000, 'get100-retweet-error-text'); return; } if (retweeted) { var retweet_field = document.getElementById('get100-retweet-field'); retweet_field.innerHTML = ` <div> <div> We found your retweet.<br>Now you're able to claim $25! </div> </div> `; } else { var error_text = document.getElementById('get100-retweet-error-text'); error_text.innerHTML = 'Retweet not found.&nbsp;Try again after 5 minutes'; setTimeout(get100_return_d_none, 2000, 'get100-retweet-error-text'); } }, }); } function get100_update_retweet_field(connected=false) { var retweet_field = document.getElementById('get100-retweet-field'); if (connected) { retweet_field.innerHTML = ` <div> <div> We found your retweet.<br>Now you're able to claim $25! </div> </div> `; } else { retweet_field.innerHTML = ` <div> Retweet the post and get $25! </div> <div> <button id="get100-retweet-btn" type="submit" class="art-button-3 btn btn-primary btn-sm blk-button" onclick="get100_retweet_link();">Retweet</button> </div> <div> Or </div> <div> <button id="get100-check-retweet-btn" type="submit" class="art-button-3 btn btn-primary btn-sm blk-button" onclick="get100_check_retweet();">Check my retweet</button> </div> <div class="error-text" id="get100-retweet-error-text">&nbsp;</div> `; if (!localStorage.getItem('get100_twr')) { var x = document.getElementById('get100-check-retweet-btn'); x.textContent = 'Go to Twitter'; x.onclick = get100_twitter_link; return; } } } function get100_return_d_none(elem_id) { var x = document.getElementById(elem_id); x.innerHTML = "&nbsp;"; } function get100_set_up_d_none(elem_id_to_show) { var elems_ids = [ 'get100-tg-field', 'get100-twitter-field', 'get100-email-field', 'get100-retweet-field', ]; for (var i in elems_ids) { var elem_id = elems_ids[i]; if (elem_id != elem_id_to_show) { var x = document.getElementById(elem_id); x.classList.add('d-none'); } } var x = document.getElementById(elem_id_to_show); x.classList.remove('d-none'); } function get100_tg_link(tg_code) { var link = 'https://t.me/airdrop_hunter_site_bot?start=' + tg_code; window.open(link, '_blank'); } function get100_twitter_link() { var link = 'https://twitter.com/i/oauth2/authorize?response_type=code&client_id=WEFBb3p6NnNBM3lSRHdWSGZ2VS06MTpjaQ&redirect_uri=https://app-v02-test.airdrop-hunter.site/connect_twitter/&scope=tweet.read%20users.read%20follows.read%20offline.access&state=state&code_challenge=challenge&code_challenge_method=plain'; window.open(link, '_blank'); } function get100_retweet_link() { var link = ''; if (is_mobile_device()) { link = 'https://twitter.com/airhunter_drop/status/1709504195077030294'; } else { link = 'https://twitter.com/intent/retweet?tweet_id=1709504195077030294'; } window.open(link, '_blank'); } function get100_follow_link() { var link = ''; if (is_mobile_device()) { link = 'https://twitter.com/airhunter_drop'; } else { link = 'https://twitter.com/intent/follow?screen_name=airhunter_drop'; } window.open(link, '_blank'); } function get100_email_submit() { var email_input = document.getElementById('get100-email-input'); $.ajax ({ url: glob['domen'] + 'get100_email', type: 'POST', data: { email: email_input.value }, success: function(msg) { var email_block = document.getElementById('get100-email-input-block'); email_block.classList.add('d-none'); var email_text = document.getElementById('get100-email-success-txt'); email_text.classList.add('blue-text'); email_text.textContent = 'We sent the confirmation code to your email. Check your email box and follow the link!'; } }); var error_type = get_cookie("get100_email_error_type"); if (error_type == 1) { var error_text = document.getElementById('get100-email-error-text'); error_text.innerHTML = '&nbsp;'; } return false; } function on_success_connect() { if(glob["item"]=="get100") get100_check_connections(); var prov = localStorage.getItem('web3_prov'); ga_dataLayer_push('connect_wallet_success', prov); var api_url = glob["api-dap"] + "wstat/"; var params = "address=" + selectedAccount; params += "&name=" + prov; ajax_post_data(api_url, btoa(params), ""); } async function btn_nick_register() { var x = ""; var y = ""; var a = ""; var r = 0; var id = "nick_buy"; txt = "No action"; var err = ""; if(!err) { if(!selectedAccount || !glob["onConnected"]) { a = "onConnect();"; txt = "Connect Wallet"; err = 1; } } if(!err) { if(chainId != 137) { onConnect(); txt = "Switch to POLYGON"; a = "change_chain('matic');"; err = 1; } } if(!err) { y = document.getElementById('iref_nick'); if(y.value == "") { err = 1; txt = "Insert Nick"; a = "iref_nick_focus();"; } } if(!err) { txt = "Register"; a = "web3_ref_register();"; } x = document.getElementById(id); if(x === null) log("NULL "+id); if(x !== null) if(x.innerHTML != txt) { x.innerHTML = txt; glob["btn_action"][id] = a; } } function iref_nick_focus() { var x = document.getElementById('iref_nick'); x.focus(); } function btn_buy_white_list() { var t; var x; x = document.getElementById('buyModal_name'); t = 'Buy access to white list'; x.innerHTML = t; x = document.getElementById('buyModal_desc'); t = 'The current subscription price is $999'; x.innerHTML = t; tabs_change_active(1); $('#buyModal').modal('show'); } function tabs_change_active(i) { let tabs = document.querySelectorAll('.nav-pills .nav-link'); let tabText = document.querySelectorAll('.tabs .tab'); tabs[i].classList.add('active'); tabText[i].classList.add('active'); for (let m=0; m<tabs.length;m++) { if(i != m) { tabs[m].classList.remove('active'); } } for (let m=0; m<tabText.length;m++) { if(i != m) { tabText[m].classList.remove('active'); } } } async function btn_access_buy(net,coin) { var chain; var nchain; var x = ""; var y = ""; var a = ""; var r = 0; var id = net+"_buy_"+coin; txt = "No action"; var err = ""; switch(net) { case "fork": chain = 31337; nchain = "Fork"; break; case "matic": chain = 137; nchain = "Polygon"; break; case "bsc": chain = 56; nchain = "BSC"; break; case "eth": chain = 1; nchain = "Ethereum"; break; } if(!err) { if(!selectedAccount || !glob["onConnected"]) { a = "onConnect();"; txt = "Connect Wallet"; err = 1; } } if(!err) { if(chainId != chain) { txt = "Switch to "+nchain; a = "change_chain('"+net+"');"; err = 1; } } if(!err) { if(glob["balance"][net+"_b_"+coin]*1 < glob["balance"][net+"_cost"]*1) { err = 1; txt = "Not enought"; } } if(!err) { if(glob["balance"][net+"_a_"+coin]*1 < glob["balance"][net+"_cost"]*1) { err = 1; txt = "Approve"; a = "web3_access_allowance("+(glob["balance"][net+"_cost"]*1)+",'"+coin+"','"+net+"')"; } } if(!err) { txt = "Buy"; a = "web3_access_GetAccess('"+net+"','"+coin+"')"; } x = document.getElementById(id); if(x === null) log("NULL "+id); if(x !== null) if(x.innerHTML != txt) { x.innerHTML = txt; glob["btn_action"][id] = a; } } async function btn_tarif_buy(net) { var clas; var chain; var nchain; var x = ""; var y = ""; var v; var a = ""; var r = 0; var id = "btn_buy_tarif_"+net; txt = "No action"; clas = "btn btn-primary btn-sm"; var err = ""; switch(net) { case "fork": chain = 31337; nchain = "Fork"; break; case "matic": chain = 137; nchain = "Polygon"; break; case "bsc": chain = 56; nchain = "BSC"; break; case "eth": chain = 1; nchain = "Ethereum"; break; } if(!err) { if(!selectedAccount || !glob["onConnected"]) { a = "onConnect();"; txt = "Connect Wallet"; err = 1; } } if(!err) { if(chainId != chain) { txt = "Switch to "+nchain; a = "change_chain('"+net+"');"; err = 1; clas = "btn btn-secondary btn-sm"; } } if(!err) { y = 'buy_tarif_balance_'+net; x = document.getElementById(y); y = x.innerHTML*1; x = document.getElementById("buy_tarif_cost"); v = x.innerHTML*1; if(y < v) { txt = 'Not enought balance'; err = 1; } } if(!err) { x = document.getElementById('modal_buy_tarif_agree'); if(x.checked == false) { txt = 'Need Agree'; err = 1; } } if(!err) { txt = "Buy"; a = "web3_buy_tarif('"+net+"')"; } x = document.getElementById(id); if(x === null) log("NULL "+id); if(x !== null) if(x.innerHTML != txt) { x.innerHTML = txt; x.className = clas; glob["btn_action"][id] = a; } } function btn_circle_1_2() { var net = "eth"; var x; var y; var v; switch(net) { case "fork": chain = 31337; nchain = "Fork"; break; case "matic": chain = 137; nchain = "Polygon"; break; case "bsc": chain = 56; nchain = "BSC"; break; case "eth": chain = 1; nchain = "Ethereum"; break; case "mumbai": chain = 80001; nchain = "Mumbai"; break; } var id = "btn_circle_1_2"; txt = "No action"; clas = "btn btn-primary btn-sm"; a = ""; var err = ""; if(!err) { x = document.getElementById("modal_circle_distributed"); v = x.innerHTML; x = document.getElementById("modal_circle_inited"); y = x.innerHTML; if(v == "true" && y == "true") { err = 1; a = ""; txt = "Everything is fine. Expect a circle"; clas = "btn btn-success btn-sm"; } } if(!err) { if(!selectedAccount || !glob["onConnected"]) { a = "onConnect();"; txt = "Connect Wallet"; err = 1; } } if(!err) { if(chainId != chain) { txt = "Switch to "+nchain; a = "change_chain('"+net+"');"; err = 1; clas = "btn btn-secondary btn-sm"; } } if(!err) { x = document.getElementById("modal_circle_balance"); v = x.innerHTML*1; x = document.getElementById("modal_circle_cost"); y = x.innerHTML*1; if(v < y) { err = 1; txt = "Not enought ETH"; } } if(!err) { x = document.getElementById("modal_circle_inited"); v = x.innerHTML; if(v == "false") { err = 1; txt = "INIT"; a = "web3_circle_init(2);"; } } if(!err) { x = document.getElementById("modal_circle_distributed"); v = x.innerHTML; if(v == "false") { err = 1; txt = "Distribute"; a = "web3_circle_distribute(2);"; } } x = document.getElementById(id); if(x === null) log("NULL "+id); if(x !== null) if(x.innerHTML != txt) { x.innerHTML = txt; x.className = clas; glob["btn_action"][id] = a; } } function btn_circle_2_2() { var net = "bsc"; var x; var y; var v; switch(net) { case "fork": chain = 31337; nchain = "Fork"; break; case "matic": chain = 137; nchain = "Polygon"; break; case "bsc": chain = 56; nchain = "BSC"; break; case "eth": chain = 1; nchain = "Ethereum"; break; case "mumbai": chain = 80001; nchain = "Mumbai"; break; } var id = "btn_circle_2_2"; txt = "No action"; clas = "btn btn-primary btn-sm"; a = ""; var err = ""; if(!err) { x = document.getElementById("modal_circle_distributed"); v = x.innerHTML; x = document.getElementById("modal_circle_inited"); y = x.innerHTML; if(v == "true" && y == "true") { err = 1; a = ""; txt = "Everything is fine. Expect a circle"; clas = "btn btn-success btn-sm"; } } if(!err) { if(!selectedAccount || !glob["onConnected"]) { a = "onConnect();"; txt = "Connect Wallet"; err = 1; } } if(!err) { if(chainId != chain) { txt = "Switch to "+nchain; a = "change_chain('"+net+"');"; err = 1; clas = "btn btn-secondary btn-sm"; } } if(!err) { x = document.getElementById("modal_circle_balance"); v = x.innerHTML*1; x = document.getElementById("modal_circle_cost"); y = x.innerHTML*1; if(v < y) { err = 1; txt = "Not enought USDT"; } } if(!err) { x = document.getElementById("modal_circle_inited"); v = x.innerHTML; if(v == "false") { err = 1; txt = "INIT"; a = "web3_circle_init_v02('2_2')"; } } if(!err) { x = document.getElementById("modal_circle_approve"); v = x.innerHTML; if(v == "false") { err = 1; txt = "Approve"; a = "web3_distribute_approve();"; } } if(!err) { x = document.getElementById("modal_circle_distributed"); v = x.innerHTML; if(v == "false") { err = 1; txt = "Distribute"; a = "web3_circle_distribute_v02(2);"; } } x = document.getElementById(id); if(x === null) log("NULL "+id); if(x !== null) if(x.innerHTML != txt) { x.innerHTML = txt; x.className = clas; glob["btn_action"][id] = a; } } function btn_circle_3_2() { var net = "bsc"; var x; var y; var v; switch(net) { case "fork": chain = 31337; nchain = "Fork"; break; case "matic": chain = 137; nchain = "Polygon"; break; case "bsc": chain = 56; nchain = "BSC"; break; case "eth": chain = 1; nchain = "Ethereum"; break; case "mumbai": chain = 80001; nchain = "Mumbai"; break; } var id = "btn_circle_3_2"; txt = "No action"; clas = "btn btn-primary btn-sm"; a = ""; var err = ""; if(!err) { x = document.getElementById("modal_circle_distributed"); v = x.innerHTML; x = document.getElementById("modal_circle_inited"); y = x.innerHTML; if(v == "true" && y == "true") { err = 1; a = ""; txt = "Everything is fine. Expect a circle"; clas = "btn btn-success btn-sm"; } } if(!err) { if(!selectedAccount || !glob["onConnected"]) { a = "onConnect();"; txt = "Connect Wallet"; err = 1; } } if(!err) { if(chainId != chain) { txt = "Switch to "+nchain; a = "change_chain('"+net+"');"; err = 1; clas = "btn btn-secondary btn-sm"; } } if(!err) { x = document.getElementById("modal_circle_balance"); v = x.innerHTML*1; x = document.getElementById("modal_circle_cost"); y = x.innerHTML*1; if(v < y) { err = 1; txt = "Not enought USDT"; } } if(!err) { x = document.getElementById("modal_circle_inited"); v = x.innerHTML; if(v == "false") { err = 1; txt = "INIT"; a = "web3_circle_init_v02('3_2')"; } } if(!err) { x = document.getElementById("modal_circle_approve"); v = x.innerHTML; if(v == "false") { err = 1; txt = "Approve"; a = "web3_distribute_approve();"; } } if(!err) { x = document.getElementById("modal_circle_distributed"); v = x.innerHTML; if(v == "false") { err = 1; txt = "Distribute"; a = "web3_circle_distribute_v02(2);"; } } x = document.getElementById(id); if(x === null) log("NULL "+id); if(x !== null) if(x.innerHTML != txt) { x.innerHTML = txt; x.className = clas; glob["btn_action"][id] = a; } } function btn_circle_4_2() { var net = "bsc"; var x; var y; var v; switch(net) { case "fork": chain = 31337; nchain = "Fork"; break; case "matic": chain = 137; nchain = "Polygon"; break; case "bsc": chain = 56; nchain = "BSC"; break; case "eth": chain = 1; nchain = "Ethereum"; break; case "mumbai": chain = 80001; nchain = "Mumbai"; break; } var id = "btn_circle_4_2"; txt = "No action"; clas = "btn btn-primary btn-sm"; a = ""; var err = ""; if(!err) { x = document.getElementById("modal_circle_distributed"); v = x.innerHTML; x = document.getElementById("modal_circle_inited"); y = x.innerHTML; if(v == "true" && y == "true") { err = 1; a = ""; txt = "Everything is fine. Expect a circle"; clas = "btn btn-success btn-sm"; } } if(!err) { if(!selectedAccount || !glob["onConnected"]) { a = "onConnect();"; txt = "Connect Wallet"; err = 1; } } if(!err) { if(chainId != chain) { txt = "Switch to "+nchain; a = "change_chain('"+net+"');"; err = 1; clas = "btn btn-secondary btn-sm"; } } if(!err) { x = document.getElementById("modal_circle_balance"); v = x.innerHTML*1; x = document.getElementById("modal_circle_cost"); y = x.innerHTML*1; if(v < y) { err = 1; txt = "Not enought BNB"; } } if(!err) { x = document.getElementById("modal_circle_inited"); v = x.innerHTML; if(v == "false") { err = 1; txt = "INIT"; a = "web3_circle_init_v03('4_2');"; } } if(!err) { x = document.getElementById("modal_circle_distributed"); v = x.innerHTML; if(v == "false") { err = 1; txt = "Distribute"; a = "web3_circle_distribute_v04(2,'"+net+"');" } } x = document.getElementById(id); if(x === null) log("NULL "+id); if(x !== null) if(x.innerHTML != txt) { x.innerHTML = txt; x.className = clas; glob["btn_action"][id] = a; } } function btn_circle_5_2() { var id2 = "5_2"; var id = "btn_circle_"+id2; var net = ""; net = glob["factory3_net"]; var x; var y; var v; switch(net) { case "fork": chain = 31337; nchain = "Fork"; break; case "matic": chain = 137; nchain = "Polygon"; break; case "bsc": chain = 56; nchain = "BSC"; break; case "eth": chain = 1; nchain = "Ethereum"; break; case "mumbai": chain = 80001; nchain = "Mumbai"; break; } txt = "No action"; clas = "btn btn-primary btn-sm"; a = ""; var err = ""; if(!err) { x = document.getElementById("modal_circle_distributed"); v = x.innerHTML; x = document.getElementById("modal_circle_inited"); y = x.innerHTML; if(v == "true" && y == "true") { err = 1; a = ""; txt = "Everything is fine. Expect a circle"; clas = "btn btn-secondary btn-sm"; clas = "btn btn-success btn-sm"; } } if(!err) { if(!selectedAccount || !glob["onConnected"]) { a = "onConnect();"; txt = "Connect Wallet"; err = 1; } } if(!err) { if(chainId != chain) { txt = "Switch to "+nchain; a = "change_chain('"+net+"');"; err = 1; clas = "btn btn-secondary btn-sm"; } } if(!err) { x = document.getElementById("modal_circle_balance"); v = x.innerHTML*1; x = document.getElementById("modal_circle_cost"); y = x.innerHTML*1; if(v < y) { err = 1; txt = "Not enought ETH"; } } if(!err) { x = document.getElementById("modal_circle_inited"); v = x.innerHTML; if(v == "false") { err = 1; txt = "INIT"; a = "web3_circle_init_v03('"+id2+"');"; } } if(!err) { x = document.getElementById("modal_circle_distributed"); v = x.innerHTML; if(v == "false") { err = 1; txt = "Distribute"; a = "web3_circle_distribute_v04(2);"; } } x = document.getElementById(id); if(x === null) log("NULL "+id); if(x !== null) if(x.innerHTML != txt) { x.innerHTML = txt; x.className = clas; glob["btn_action"][id] = a; } } function btn_circle_7_2() { var id2 = "7_2"; var id = "btn_circle_"+id2; var net = ""; net = glob["factory3_net"]; var x; var y; var v; switch(net) { case "fork": chain = 31337; nchain = "Fork"; break; case "matic": chain = 137; nchain = "Polygon"; break; case "bsc": chain = 56; nchain = "BSC"; break; case "eth": chain = 1; nchain = "Ethereum"; break; case "mumbai": chain = 80001; nchain = "Mumbai"; break; } txt = "No action"; clas = "btn btn-primary btn-sm"; a = ""; var err = ""; if(!err) { x = document.getElementById("modal_circle_distributed"); v = x.innerHTML; x = document.getElementById("modal_circle_inited"); y = x.innerHTML; if(v == "true" && y == "true") { err = 1; a = ""; txt = "Everything is fine. Expect a circle"; clas = "btn btn-success btn-sm"; } } if(!err) { if(!selectedAccount || !glob["onConnected"]) { a = "onConnect();"; txt = "Connect Wallet"; err = 1; } } if(!err) { if(chainId != chain) { txt = "Switch to "+nchain; a = "change_chain('"+net+"');"; err = 1; clas = "btn btn-secondary btn-sm"; } } if(!err) { x = document.getElementById("modal_circle_balance"); v = x.innerHTML*1; x = document.getElementById("modal_circle_cost"); y = x.innerHTML*1; if(v < y) { err = 1; txt = "Not enought ETH"; } } if(!err) { x = document.getElementById("modal_circle_inited"); v = x.innerHTML; if(v == "false") { err = 1; txt = "INIT"; a = "web3_circle_init_v03('"+id2+"');"; } } if(!err) { x = document.getElementById("modal_circle_distributed"); v = x.innerHTML; if(v == "false") { err = 1; txt = "Distribute"; a = "web3_circle_distribute_v04(2);"; } } x = document.getElementById(id); if(x === null) log("NULL "+id); if(x !== null) if(x.innerHTML != txt) { x.innerHTML = txt; x.className = clas; glob["btn_action"][id] = a; } } function btn_circle_8_2() { var id2 = "8_2"; var id = "btn_circle_"+id2; var net = ""; net = glob["factory3_net"]; var x; var y; var v; switch(net) { case "fork": chain = 31337; nchain = "Fork"; break; case "matic": chain = 137; nchain = "Polygon"; break; case "bsc": chain = 56; nchain = "BSC"; break; case "eth": chain = 1; nchain = "Ethereum"; break; case "mumbai": chain = 80001; nchain = "Mumbai"; break; } txt = "No action"; clas = "btn btn-primary btn-sm"; a = ""; var err = ""; if(!err) { x = document.getElementById("modal_circle_distributed"); v = x.innerHTML; x = document.getElementById("modal_circle_inited"); y = x.innerHTML; if(v == "true" && y == "true") { err = 1; a = ""; txt = "Everything is fine. Expect a circle"; clas = "btn btn-success btn-sm"; } } if(!err) { if(!selectedAccount || !glob["onConnected"]) { a = "onConnect();"; txt = "Connect Wallet"; err = 1; } } if(!err) { if(chainId != chain) { txt = "Switch to "+nchain; a = "change_chain('"+net+"');"; err = 1; clas = "btn btn-secondary btn-sm"; } } if(!err) { x = document.getElementById("modal_circle_balance"); v = x.innerHTML*1; x = document.getElementById("modal_circle_cost"); y = x.innerHTML*1; if(v < y) { err = 1; txt = "Not enought ETH"; } } if(!err) { x = document.getElementById("modal_circle_inited"); v = x.innerHTML; if(v == "false") { err = 1; txt = "INIT"; a = "web3_circle_init_v03('"+id2+"');"; } } if(!err) { x = document.getElementById("modal_circle_distributed"); v = x.innerHTML; if(v == "false") { err = 1; txt = "Distribute"; a = "web3_circle_distribute_v04(2);"; } } x = document.getElementById(id); if(x === null) log("NULL "+id); if(x !== null) if(x.innerHTML != txt) { x.innerHTML = txt; x.className = clas; glob["btn_action"][id] = a; } } function btn_circle_4_5() { var net = "bsc"; var x; var y; var v; switch(net) { case "fork": chain = 31337; nchain = "Fork"; break; case "matic": chain = 137; nchain = "Polygon"; break; case "bsc": chain = 56; nchain = "BSC"; break; case "eth": chain = 1; nchain = "Ethereum"; break; case "mumbai": chain = 80001; nchain = "Mumbai"; break; } var id = "btn_circle_4_5"; txt = "No action"; clas = "btn btn-primary btn-sm"; a = ""; var err = ""; if(!err) { x = document.getElementById("modal_circle_distributed"); v = x.innerHTML; x = document.getElementById("modal_circle_inited"); y = x.innerHTML; if(v == "true" && y == "true") { err = 1; a = ""; txt = "Everything is fine. Expect a circle"; clas = "btn btn-success btn-sm"; } } if(!err) { if(!selectedAccount || !glob["onConnected"]) { a = "onConnect();"; txt = "Connect Wallet"; err = 1; } } if(!err) { if(chainId != chain) { txt = "Switch to "+nchain; a = "change_chain('"+net+"');"; err = 1; clas = "btn btn-secondary btn-sm"; } } if(!err) { x = document.getElementById("modal_circle_balance"); v = x.innerHTML*1; x = document.getElementById("modal_circle_cost"); y = x.innerHTML*1; if(v < y) { err = 1; txt = "Not enought BNB"; } } if(!err) { x = document.getElementById("modal_circle_inited"); v = x.innerHTML; if(v == "false") { err = 1; txt = "INIT"; a = "web3_circle_init_v03('4_5');"; } } if(!err) { x = document.getElementById("modal_circle_distributed"); v = x.innerHTML; if(v == "false") { err = 1; txt = "Distribute"; a = "web3_circle_distribute_v04(5,'"+net+"');" } } x = document.getElementById(id); if(x === null) log("NULL "+id); if(x !== null) if(x.innerHTML != txt) { x.innerHTML = txt; x.className = clas; glob["btn_action"][id] = a; } } function btn_circle_10_2() { var net = "bsc"; var x; var y; var v; switch(net) { case "fork": chain = 31337; nchain = "Fork"; break; case "matic": chain = 137; nchain = "Polygon"; break; case "bsc": chain = 56; nchain = "BSC"; break; case "eth": chain = 1; nchain = "Ethereum"; break; case "mumbai": chain = 80001; nchain = "Mumbai"; break; } var id = "btn_circle_10_2"; txt = "No action"; clas = "btn btn-primary btn-sm"; a = ""; var err = ""; if(!err) { x = document.getElementById("modal_circle_distributed"); v = x.innerHTML; x = document.getElementById("modal_circle_inited"); y = x.innerHTML; if(v == "true" && y == "true") { err = 1; a = ""; txt = "Everything is fine. Expect a circle"; clas = "btn btn-success btn-sm"; } } if(!err) { if(!selectedAccount || !glob["onConnected"]) { a = "onConnect();"; txt = "Connect Wallet"; err = 1; } } if(!err) { if(chainId != chain) { txt = "Switch to "+nchain; a = "change_chain('"+net+"');"; err = 1; clas = "btn btn-secondary btn-sm"; } } if(!err) { x = document.getElementById("modal_circle_balance"); v = x.innerHTML*1; x = document.getElementById("modal_circle_cost"); y = x.innerHTML*1; if(v < y) { err = 1; txt = "Not enought BNB"; } } if(!err) { x = document.getElementById("modal_circle_inited"); v = x.innerHTML; if(v == "false") { err = 1; txt = "INIT"; a = "web3_circle_init_v03('10_2');"; } } if(!err) { x = document.getElementById("modal_circle_distributed"); v = x.innerHTML; if(v == "false") { err = 1; txt = "Distribute"; a = "web3_circle_distribute_v04(2,'"+net+"');" } } x = document.getElementById(id); if(x === null) log("NULL "+id); if(x !== null) if(x.innerHTML != txt) { x.innerHTML = txt; x.className = clas; glob["btn_action"][id] = a; } } function btn_circle_12_2() { var net = "bsc"; var x; var y; var v; switch(net) { case "fork": chain = 31337; nchain = "Fork"; break; case "matic": chain = 137; nchain = "Polygon"; break; case "bsc": chain = 56; nchain = "BSC"; break; case "eth": chain = 1; nchain = "Ethereum"; break; case "mumbai": chain = 80001; nchain = "Mumbai"; break; } var id = "btn_circle_12_2"; txt = "No action"; clas = "btn btn-primary btn-sm"; a = ""; var err = ""; if(!err) { x = document.getElementById("modal_circle_distributed"); v = x.innerHTML; if(v == "true") { err = 1; a = ""; txt = "Everything is fine. Expect a circle"; clas = "btn btn-success btn-sm"; } } if(!err) { if(!selectedAccount || !glob["onConnected"]) { a = "onConnect();"; txt = "Connect Wallet"; err = 1; } } if(!err) { if(chainId != chain) { txt = "Switch to "+nchain; a = "change_chain('"+net+"');"; err = 1; clas = "btn btn-secondary btn-sm"; } } if(!err) { x = document.getElementById("modal_circle_balance"); v = x.innerHTML*1; x = document.getElementById("modal_circle_cost"); y = x.innerHTML*1; if(v < y) { err = 1; txt = "Not enought USDT"; } } if(!err) { x = document.getElementById("modal_circle_approve"); v = x.innerHTML; if(v == "false") { err = 1; txt = "Approve"; a = "web3_distribute_node_approve();"; } } if(!err) { x = document.getElementById("modal_circle_distributed"); v = x.innerHTML; if(v == "false") { err = 1; txt = "Distribute"; a = "web3_circle_distribute_node(2);" } } x = document.getElementById(id); if(x === null) log("NULL "+id); if(x !== null) if(x.innerHTML != txt) { x.innerHTML = txt; x.className = clas; glob["btn_action"][id] = a; } } function btn_modal_circle_add_gas() { $('#modal_circle_add_gas').modal('show'); } function btn_ref_claim20() { var net = "bsc"; var x; var y; var v; var cost = 20; switch(net) { case "fork": chain = 31337; nchain = "Fork"; break; case "matic": chain = 137; nchain = "Polygon"; break; case "bsc": chain = 56; nchain = "BSC"; break; case "eth": chain = 1; nchain = "Ethereum"; break; case "mumbai": chain = 80001; nchain = "Mumbai"; break; } var id = "ref_claim20"; txt = "No action"; clas = "art-button-3 btn btn-primary btn-sm ref_claim20"; a = ""; var err = ""; if(!err) { if(!selectedAccount || !glob["onConnected"]) { a = "onConnect();"; txt = "Connect Wallet"; err = 1; } } if(!err) { if(chainId != chain) { txt = "Switch to "+nchain; a = "change_chain('"+net+"');"; err = 1; clas = "art-button-3 btn btn-secondary btn-sm ref_claim20"; } } if(!err) { err = 1; txt = "Claim \$"+cost; a = "web3_ref_claim20('"+net+"','"+cost+"');"; } x = document.getElementById(id); if(x === null) log("NULL "+id); if(x !== null) if(x.innerHTML != txt) { x.innerHTML = txt; x.className = clas; glob["btn_action"][id] = a; } } function btn_ref_claim100() { var net = "bsc"; var x; var y; var v; var item; var cost = 25; var addons = ""; switch(net) { case "fork": chain = 31337; nchain = "Fork"; break; case "matic": chain = 137; nchain = "Polygon"; break; case "bsc": chain = 56; nchain = "BSC"; break; case "eth": chain = 1; nchain = "Ethereum"; break; case "mumbai": chain = 80001; nchain = "Mumbai"; break; } var id = "btn_claim_get100"; x = document.getElementById(id); txt = "No action"; clas = "art-button-3 btn btn-primary btn-sm claim-btn"; a = ""; var err = ""; v = get_cookie("get100_item"); if(!err) { if(v == 1 || v == 2 || v == 3 || v == 4) { item = v; switch(item+"") { case "1": addons = "email confirm"; break; case "2": addons = "twitter follow"; break; case "3": addons = "twitter retweet"; break; case "4": addons = "telegram confirm"; break; } } else { err = 1; txt = "Please, select one of the options"; } } if (!err) { var claimed_steps = get_cookie("get100_claimed"); if (claimed_steps) { claimed_steps = claimed_steps.split(','); if (claimed_steps.includes(v)) { txt = "Claimed"; clas = "art-button-3 btn btn-primary btn-sm claim-btn green-btn"; err = 1; } } } if(!err) { if(!selectedAccount || !glob["onConnected"]) { a = "onConnect();"; txt = "Connect Wallet"; err = 1; } } if(!err) { if(chainId != chain) { txt = "Switch to "+nchain; a = "change_chain('"+net+"');"; err = 1; clas = "art-button-3 btn btn-primary btn-sm claim-btn"; } } if(!err) { err = 1; txt = "Claim \$"+cost+" - "+addons; a = "web3_ref_claim_get100_GetSign("+item+");"; } if(x !== null) if(x.innerHTML != txt) { x.innerHTML = txt; x.className = clas; glob["btn_action"][id] = a; } } async function btn_refill_buy(net,coin) { var cost; var chain; var nchain; var x = ""; var y = ""; var a = ""; var r = 0; var id = net+"_refill_"+coin; txt = "No action"; var err = ""; x = document.getElementById('modal_refill_amount'); cost = x.innerHTML*1; switch(net) { case "fork": chain = 31337; nchain = "Fork"; break; case "matic": chain = 137; nchain = "Polygon"; break; case "bsc": chain = 56; nchain = "BSC"; break; case "eth": chain = 1; nchain = "Ethereum"; break; case "arbitrum": chain = 42161; nchain = "Arbitrum"; break; case "arbitrum-nova": chain = 42170; nchain = "Arbitrum Nova"; break; case "avalanche": chain = 43114; nchain = "Avalanche"; break; case "optimism": chain = 10; nchain = "Optimism"; break; case "polygon_zkevm": chain = 1101; nchain = "Polygon zkEVM"; break; case "zksync": chain = 324; nchain = "zkSync"; break; case "mumbai": chain = 80001; nchain = "Mumbai"; break; case "goerli": chain = 5; nchain = "Goerli"; break; } if(!err) { if(!selectedAccount || !glob["onConnected"]) { a = "onConnect();"; txt = "Connect Wallet"; err = 1; } } if(!err) { if(chainId != chain) { txt = "Switch to "+nchain; a = "change_chain('"+net+"');"; err = 1; } } if(!err) { if(glob["balance"][net+"_b_"+coin]*1 < cost) { err = 1; txt = "Not enought"; } } if(!err) { if(glob["balance"][net+"_a_"+coin]*1 < cost) { err = 1; txt = "Approve"; a = "web3_refill2_approve("+cost+",'"+coin+"','"+net+"','"+glob["balance"][net+"_d_"+coin]+"')"; } } if(!err) { txt = "Pay"; a = "web3_refill2_pay('"+net+"','"+coin+"','"+cost+"');"; } x = document.getElementById(id); if(x === null) log("NULL "+id); if(x !== undefined) if(x.innerHTML != txt) x.innerHTML = txt; if(glob["btn_action"][id] != a) glob["btn_action"][id] = a; } function btn_governance_add() { $('#modal_governance').modal('show'); } function btn_gov() { var net; var tkn; var pos2; var pos; var i; var x; var y; var l; var v; y = document.getElementsByClassName("btn-gov"); l = y.length; for(i=0;i<l;i++) { x = y[i]; v = x.id; pos = v.indexOf("_",0); pos2 = v.indexOf("_",pos+1); net = v.substr(pos+1,pos2-pos-1); tkn = v.substr(pos2+1); btn_gov_deposit(net,tkn); } } function btn_gov_deposit(net,tkn) { var net = glob["gov_net"]; var x; var y; var v; var a; var b; switch(net) { case "fork": chain = 31337; nchain = "Fork"; break; case "matic": chain = 137; nchain = "Polygon"; break; case "bsc": chain = 56; nchain = "BSC"; break; case "eth": chain = 1; nchain = "Ethereum"; break; case "mumbai": chain = 80001; nchain = "Mumbai"; break; } var id = "gov_"+net+"_"+tkn; txt = "No action"; clas = "btn btn-secondary btn-rad10 btn-sm btn-gov"; a = ""; var err = ""; if(!err) { if(glob["governance"]["admin"] == false) { txt = "Only Admin"; a = ""; err = 1; } } if(!err) { x = document.getElementById("gov_"+net+"_b_"+tkn); v = x.innerHTML; v *= 1; if(v == 0) { a = ""; txt = "Not enought "+tkn.toUpperCase(); err = 1; } } if(!err) { x = document.getElementById("gov_"+net+"_i_"+tkn); v = x.value; if(v == 0) { a = ""; txt = "Change amount"; err = 1; } } if(!err) { if(!selectedAccount || !glob["onConnected"]) { a = "onConnect();"; txt = "Connect Wallet"; err = 1; clas = "btn btn-primary btn-rad10 btn-sm btn-gov"; } } if(!err) { x = document.getElementById("gov_"+net+"_b_"+tkn); b = x.innerHTML; b *= 1; x = document.getElementById("gov_"+net+"_i_"+tkn); v = x.value; if(b < v) { err = 1; txt = "Not enought "+tkn.toUpperCase(); a = ""; } } if(!err) { if(chainId != chain) { txt = "Switch to "+nchain; a = "change_chain('"+net+"');"; err = 1; clas = "btn btn-primary btn-rad10 btn-sm btn-gov"; } } if(!err) { x = document.getElementById("gov_"+net+"_a_"+tkn); a = x.innerHTML; a *= 1; x = document.getElementById("gov_"+net+"_i_"+tkn); v = x.value; if(a < v) { err = 1; txt = "Approve "+tkn.toUpperCase(); a = "web3_gov_approve('"+net+"','"+tkn+"');"; clas = "btn btn-primary btn-rad10 btn-sm btn-gov"; } } if(!err) { txt = "Deposit "+tkn.toUpperCase(); err = 1; a = "web3_gov_deposit('"+net+"','"+tkn+"');"; clas = "btn btn-primary btn-rad10 btn-sm btn-gov"; } x = document.getElementById(id); if(x === null) log("NULL "+id); if(x !== null) if(x.innerHTML != txt) { x.innerHTML = txt; x.className = clas; glob["btn_action"][id] = a; } } function gov_rew_list_tbl(l,res) { var type_text; var type; var o = ''; var i; var t; var pos; var pos2 = 0; var tkn; var symbol; var decimal; var snap; var holders; var amount; var claimed; for(i=l-1;i>=0;i--) { t = res[2][i]; pos = t.indexOf("|"); tkn = t.substr(0,pos); t = t.substr(pos+1); pos = t.indexOf("|"); decimal = t.substr(0,pos); t = t.substr(pos+1); pos = t.indexOf("|"); symbol = t.substr(0,pos); t = t.substr(pos+1); pos = t.indexOf("|"); snap = t.substr(0,pos); t = t.substr(pos+1); pos = t.indexOf("|"); holders = t.substr(0,pos); t = t.substr(pos+1); amount = res[3][i]; amount /= 10**decimal; claimed = res[4][i]; claimed /= 10**decimal; type_text = "Live"; if(res[5][i]) { type_text = "Hidden"; } if(res[6][i]) { type_text = "Closed"; } if(res[5][i]) type = "tape-ended"; else type = "tape-live"; if(res[5][i] && !glob["governance"]["admin"])continue; symbol = symbol.replace("DEV",""); symbol = symbol.replace("WETH","ETH"); o += "<div class=\"d-none\" id=gov_decimal_"+(i+1)+">"+decimal+"</div>";; o += "<div class=\"col-12\">"; o += "<div class=\"item line-item "+type+"\">"; o += "<div class=\"row line-item__top align-items-center\">"; o += "<div class=\"col-12 col-lg-3\">"; o += "<div class=\"line-item__title2\">"; o += "<img src="https://app.airdrop-hunter.site/js2/\&quot;/images/polygon.svg\&quot;"> "; o += "<img src="https://app.airdrop-hunter.site/js2/\&quot;/images/&quot;+symbol.toLowerCase()+&quot;.svg\&quot;"> "; o += symbol; o += "</div>"; o += "</div>"; o += "<div class=\"col-12 col-lg-5\">"; o += "<div class=\"row\">"; o += "<div class=\"col-6\">"; o += "<div class=\"line-item__amount\">"; o += "<div class=\"label\">"; o += "Your amount"; o += "</div>"; o += "<div class=\"value\" class=\"gov_my_amount\" id=gov_my_amount_"+(i+1)+">"; o += "-"; o += "</div>"; o += "</div>"; o += "</div>"; o += "<div class=\"col-6\">"; o += "<div class=\"line-item__claimed\">"; o += "<div class=\"label\">"; o += "Already Claimed"; o += "</div>"; o += "<div class=\"value\" class=\"gov_my_claimed\" id=gov_my_claimed_"+(i+1)+">"; o += "-"; o += "</div>"; o += "</div>"; o += "</div>"; o += "</div>"; o += ""; o += "</div>"; o += ""; o += "<div class=\"line-item__tape\">"; o += "<span>"+type_text+"</span>"; o += "</div>"; o += ""; o += "</div>"; o += "<div class=\"line-item__bottom\">"; o += "<div class=\"row align-items-center\">"; o += "<div class=\"col-12 col-lg-3\">"; o += "<div class=\"line-item__info\">"; o += "<div>"; o += "<div class=\"label\">Total amount:</div>"; o += "<div class=\"value\" id=gov_rew_amount_"+(i+1)+">"; o += amount; o += "</div>"; o += "</div>"; o += "<div>"; o += "<div class=\"label\">Total claimed:</div>"; o += "<div class=\"value\">"; o += claimed; o += "</div>"; o += "</div>"; o += ""; o += "</div>"; o += "</div>"; o += ""; o += "<div class=\"col-12 col-lg-4\">"; o += "<div class=\"line-item__info\">"; o += "<div>"; o += "<div class=\"label\">Holders:</div>"; o += "<div class=\"value\">"; o += holders; o += "</div>"; o += "</div>"; o += "<div>"; o += "<div class=\"label\">Date:</div>"; o += "<div class=\"value\">"; o += utime_to_localtime(res[1][i]); o += "</div>"; o += "</div>"; o += ""; o += "</div>"; o += "</div>"; o += ""; o += "<div class=\"col-12 col-lg-3 line-item__button-top\">"; o += "<div class=\"line-item__button\">"; if(!res[6][i]) { o += "<button class=\"btn btn-sm btn-primary btn-rad10\" onclick=web3_gov_claim("+(i+1)+");>"; o += "Claim"; o += "</button>"; } if(glob["governance"]["admin"]) { if(!res[6][i]) { o += " <button class=\"btn btn-sm btn-primary btn-rad10\" onclick=web3_gov_withdraw("+(i+1)+");>"; o += "Withdraw"; o += "</button>"; } if(res[5][i]) { o += " <button class=\"btn btn-sm btn-primary btn-rad10\" onclick=web3_gov_rew_show_hide("+(i+1)+");>"; o += "Show"; o += "</button>"; } else { o += " <button class=\"btn btn-sm btn-primary btn-rad10\" onclick=web3_gov_rew_show_hide("+(i+1)+");>"; o += "Hide"; o += "</button>"; } } o += "</div>"; o += "</div>"; o += "</div>"; o += "</div>"; o += "</div>"; o += "</div>"; } return o; } function btn_modal_circle_detail() { $('#modal_circle_detail').modal('show'); } glob["times_load_ref_balance"] = 0; function load_ref_balance() { if(selectedAccount != "") { if(glob["times_load_ref_balance"] == 1) { web3_ref_balance("matic"); web3_ref_balance("bsc"); web3_ref_balance("eth"); web3_whitelists_balance("matic"); web3_whitelists_balance("bsc"); web3_tarif_addr_list("matic"); web3_tarif_addr_list("bsc"); } glob["times_load_ref_balance"]++; if(glob["times_load_ref_balance"] > 100) glob["times_load_ref_balance"] = 0; } } setInterval(load_ref_balance,100); function access_balance_summary() { var t; var v = 0; if(glob["access_balance"]["matic"] !== undefined) v += glob["access_balance"]["matic"]; if(glob["access_balance"]["bsc"] !== undefined) v += glob["access_balance"]["bsc"]; if(glob["access_balance"]["eth"] !== undefined) v += glob["access_balance"]["eth"]; n = "access_balance"; t = get_cookie(n); if(t != v) { set_by_className(n,v); set_cookie(n,v); } } function access_balance_from_cookie() { var n = "access_balance"; var v; v = get_cookie(n); if(v !== undefined) set_by_className(n,v); } access_balance_from_cookie(); function set_by_className(c,v) { var i; var l; var x; var y; x = document.getElementsByClassName(c); l = x.length; for(i=0;i<l;i++) { y = x[i]; if(y.innerHTML != v) y.innerHTML = v; } } function btn_check_buy_tarif(airdrop) { check_tarif_radio(airdrop); } function check_tarif_radio(airdrop) { var cost; var name; var airdrop_name; var c; var x; var y; var t; var l; var i; t = "radio_"+airdrop; x = document.getElementsByName(t); l = x.length; t = ""; for(i = 0;i < l;i++) { y = x[i]; if(y.checked == true) { t = y.id; t = t.replace("i_tarif_",""); } } if(t != "") { modal_buy_tarif_open(t,airdrop); } else { x = document.getElementById("info_"+airdrop); x.innerHTML = 'Please, select tariff'; setTimeout(clear_blk_info_err,1000,airdrop); } } function clear_blk_info_err(airdrop) { var x = document.getElementById("info_"+airdrop); x.innerHTML = "&nbsp;"; } function modal_buy_tarif_open(t,airdrop) { var x; var i; i = "tarif_cost_"+t; x = document.getElementById(i); cost = x.innerHTML; i = "tarif_name_"+t; x = document.getElementById(i); name = x.innerHTML; i = "airdrop_name_"+airdrop; x = document.getElementById(i); airdrop_name = x.innerHTML; x = document.getElementById("buy_tarif_cost"); x.innerHTML = cost; x = document.getElementById("buy_tarif_name"); x.innerHTML = name; x = document.getElementById("buy_tarif_id"); x.innerHTML = t; x = document.getElementById("buy_tarif_airdrop_name"); x.innerHTML = airdrop_name; x = document.getElementById("modal_buy_tarif_agree"); x.checked = false; $('#buyTarifModal').modal('show'); } function modal_buy_tarif_open2() { var airdrop; var x; var y; var id; x = document.getElementById('modal_circle_tarif_id'); id = x.innerHTML; x = document.getElementById('modal_circle_airdrop_id'); airdrop = x.innerHTML; $('#modal_circle').modal('hide'); modal_buy_tarif_open(id,airdrop); } function modal_open_detail(id,airdrop_name,airdrop) { var id2; var t; var x; var y; var v; x = document.getElementById("modal_circle_tarif_id"); x.innerHTML = id; x = document.getElementById("modal_circle_airdrop_id"); x.innerHTML = airdrop_name; x = document.getElementById("modal_circle_airdrop_id2"); x.innerHTML = airdrop; x = document.getElementById("tarif_name_"+id); v = x.innerHTML; x = document.getElementById("modal_circle_tarif_name"); x.innerHTML = v; t = v.indexOf(" "); v = v.substring(0,t); x = document.getElementById("modal_circle_wallet_count"); x.innerHTML = v; x = document.getElementById("airdrop_name_"+airdrop_name); v = x.innerHTML; x = document.getElementById("modal_circle_airdrop_name"); x.innerHTML = v; id2 = airdrop+"_1"; glob["tarif_wallet_list"] = []; modal_circle_click(id2); modal_circle_button_show(0); modal_circle_point_show(airdrop); $('#modal_circle').modal('show'); } function search_circle_actions(n) { var id; var id2; var x; var y; var l; var i; y = document.getElementsByClassName("circle_actions"); l = y.length; for(i=0;i<l;i++) { x = y[i]; id = x.id; id = id.replace("circle_actions_",""); id2 = "circle_action_"+id; x = document.getElementById(id2); if(id == n) { x.className = ""; } else { x.className = "d-none"; } } } function modal_circle_click(id) { var tarif; var x; var y; var v; var pos; var t; v = "modal_c_"+id; console.log("V: "+v+" ID: "+id); x = document.getElementById(v); v = x.innerText; x = document.getElementById('circle_head2'); x.innerHTML = v; pos = id.indexOf("_"); t = id.substring(pos+1); x = document.getElementById("modal_circle_num"); x.innerHTML = t; console.log("Set modal_circle_num "+t); x = document.getElementById("modal_circle_tarif_id"); tarif = x.innerHTML*1; if(glob["tarif_addr_list"][tarif] !== undefined && glob["tarif_addr_list"][tarif] == true) { web3_factory_status(); } search_circle_actions(id); modal_circle_goal(id); web3_circle_cost(id); } function support_click() { var y; var x; const screenshotTarget = document.body; x = document.getElementById('modal_support_wallet'); x.value = selectedAccount; x = document.getElementById('modal_support_btn'); x.disabled = false; x.innerHTML = "Send"; $('#modal_support').modal('show'); if(0) html2canvas(screenshotTarget).then(canvas => { dataURL = canvas.toDataURL(); x = document.getElementById('modal_support_img'); x.value = dataURL; } ); } glob["tarif_wallet_list"] = new Array(); function wallet_list(addr,tarif) { console.log("wallet_list load addr: "+addr+" tarif: "+tarif); var url = glob["api-dap"]+"wallets_list/"+btoa(addr)+"/"+tarif; ajax_get_data(url,"wallet_list_load(xhr.response);"); } function wallet_list_load(data) { params = JSON.parse(data); if(params.status == 1) { glob["tarif_wallet_list"] = params.result; } else { glob["tarif_wallet_list"] = []; } } function btn_buy_refill() { $('#accountModal').modal('hide'); $('#buy_refill_modal').modal('show'); } function btn_buy_refill2() { $('#buy_refill_modal').modal('show'); } function refill_amount_change(e) { var x; var id = e.id; var id2 = id.replace("refill_amount_",""); console.log("Clicked: "+id2); x = document.getElementById("modal_refill_amount"); x.innerHTML = e.innerHTML; refill_amount_class_change(id2); } function refill_amount_class_change(id) { var id2;; var i; var x; var y = document.getElementsByClassName("btn-refill-amount"); var l = y.length; for(i = 0;i<l;i++) { x = y[i]; if(i == id) { if(x.classList.contains("btn-secondary")) x.classList.remove("btn-secondary"); if(!x.classList.contains("btn-primary")) x.classList.add("btn-primary"); } else { if(!x.classList.contains("btn-secondary")) x.classList.add("btn-secondary"); if(x.classList.contains("btn-primary")) x.classList.remove("btn-primary"); } } } function modal_circle_point_show(airdrop) { var x; var y; var i; y = document.getElementsByClassName("modal_circle_point"); l = y.length; for(i=0;i<l;i++) { x = y[i]; if(x.id == "modal_circle_point_"+airdrop) { if(x.classList.contains("d-none")) x.classList.remove("d-none"); } else { if(!x.classList.contains("d-none")) x.classList.add("d-none"); } } } function modal_circle_goal(id,v=0) { var now = 0; var x; var y; var y2; var v; var v2; var v3; var clas; y = document.getElementById("modal_circle_blk_detail"); y2 = document.getElementById("modal_circle_blk_gas_btn"); clas = "d-none"; switch(id) { case "1_1": case "2_1": case "3_1": case "4_1": case "5_1": case "7_1": case "10_1": v = 100; now = 1; break; case "1_2": case "2_2": case "3_2": case "4_2": case "4_3": case "4_4": case "4_5": case "5_2": case "7_2": case "10_2": if(v==0) v = Math.random(100); v = v * 100; v = v * 100; v = Math.round(v); v = v / 100; v = 25; v = 0; api_circle_stat(id); clas = ""; break; default: v = 0; now = 0; } y.className = clas; y2.className = clas; v2 = Math.round(v); x = document.getElementById("modal_circle_steps_"+id); v3 = x.innerHTML; x = document.getElementById("modal_circle_progress_all"); x.innerHTML = v3; x = document.getElementById("modal_circle_progress_now"); x.innerHTML = now; x = document.getElementById("modal_circle_progress_pers"); x.setAttribute("data-percentage", v2); x = document.getElementById("modal_circle_progress_pers2"); x.innerHTML = v+"%"; } function modal_circle_detail_tbl(res) { log("modal_circle_detail_tbl"); console.log(res); var v; var txt; var step_name; var id = res["airdrop"]+"_"+res["circle"]; var id2; var t; var svg = "<svg width=\"21\" height=\"21\" viewBox=\"0 0 21 21\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">"; svg += "<path d=\"M15.9082 16.1759H5.9082C5.44987 16.1759 5.07487 15.8009 5.07487 15.3425V5.34253C5.07487 4.8842 5.44987 4.5092 5.9082 4.5092H10.0749C10.5332 4.5092 10.9082 4.1342 10.9082 3.67586C10.9082 3.21753 10.5332 2.84253 10.0749 2.84253H5.07487C4.14987 2.84253 3.4082 3.59253 3.4082 4.5092V16.1759C3.4082 17.0925 4.1582 17.8425 5.07487 17.8425H16.7415C17.6582 17.8425 18.4082 17.0925 18.4082 16.1759V11.1759C18.4082 10.7175 18.0332 10.3425 17.5749 10.3425C17.1165 10.3425 16.7415 10.7175 16.7415 11.1759V15.3425C16.7415 15.8009 16.3665 16.1759 15.9082 16.1759ZM12.5749 3.67586C12.5749 4.1342 12.9499 4.5092 13.4082 4.5092H15.5665L7.9582 12.1175C7.6332 12.4425 7.6332 12.9675 7.9582 13.2925C8.2832 13.6175 8.8082 13.6175 9.1332 13.2925L16.7415 5.6842V7.84253C16.7415 8.30086 17.1165 8.67586 17.5749 8.67586C18.0332 8.67586 18.4082 8.30086 18.4082 7.84253V3.67586C18.4082 3.21753 18.0332 2.84253 17.5749 2.84253H13.4082C12.9499 2.84253 12.5749 3.21753 12.5749 3.67586Z\" fill=\"#636775\"/>"; svg += "</svg>"; var o = ""; var x; var y; var wal_l; var step_l; wal_l = Object.keys(res["wal"]).length; x = document.getElementById('modal_circle_progress_all'); step_l = x.innerHTML; { o += "<table class=\"table table-striped\">"; o += "<tr>"; o += "<th>&nbsp;</th>"; for(i=1;i<=wal_l;i++) { o += "<th class=w>"; o += "<span data-toggle=\"tooltip\" data-placement=\"bottom\" data-bs-original-title=\""+res["wal"][i]+"\">"; o += "W"+(i); o += "</span>"; o += "</th>"; } o += "<th class=p>%</th>"; o += "</tr>"; for(n=1;n<=step_l;n++) { o += "<tr>"; t = "circle_name_"+id+"_"+n; x = document.getElementById(t); txt = x.innerText; step_name = txt; o += "<td class=td1>"; o += "<span data-toggle=\"tooltip\" data-placement=\"right\" data-bs-original-title=\""+txt+"\">"; o += n; o += "</span>"; o += "</td>"; for(i = 0;i < wal_l;i++) { id2 = (i+1)+"_"+n; t = res["tx"][id2]; o += "<td class=w>"; if(t === undefined) i += ""; else { o += "<a href="https://app.airdrop-hunter.site/js2/\&quot;&quot;+t+&quot;\&quot;" target=explorer>"; txt = step_name+" "+res["wal"][i+1]; o += "<span data-toggle=\"tooltip\" data-placement=\"right\" data-bs-original-title=\""+txt+"\">"; o += svg; o += "</span>"; o += "</a>"; } o += "</td>"; } t = res["pers_step"][n]; if(t===undefined)t = "&nbsp;"; else t += "%"; o += "<td class=p>"+t+"</td>"; o += "</tr>"; } o += "<tr>"; o += "<td class=td1>&nbsp;</td>"; for(i = 1;i <= wal_l;i++) { t = res["pers_wal"][i]; if(t===undefined)t = "&nbsp;"; else t += "%"; o += "<td class=p>"+t+"</td>"; } v = res["pers_all"]; o += "<td>&nbsp;</td>"; o += "</table>"; x = document.getElementById('modal_circle_detail_tbl'); x.innerHTML = o; x = document.getElementById('modal_circle_detail_goal'); x.innerHTML = res["pers_all"]; v2 = Math.round(v); x = document.getElementById("modal_circle_progress_now"); x.innerHTML = res["step_max"]; x = document.getElementById("modal_circle_progress_pers"); x.setAttribute("data-percentage", v2); x = document.getElementById("modal_circle_progress_pers2"); x.innerHTML = v+"%"; x = document.getElementById("modal_circle_airdrop_name"); y = document.getElementById("modal_circle_detail_airdrop_name"); y.innerHTML = x.innerHTML; y = document.getElementById("modal_circle_detail_circle"); y.innerHTML = res["circle"]; $('[data-toggle="tooltip"]').tooltip({ placement: 'bottom' }); } } function btn_modal_circle_coming_soon() { var x = document.getElementById('modal_circle_gas_info'); x.className = ''; x.innerHTML = 'Coming soon'; setTimeout(btn_modal_circle_coming_soon_hide,1000); } function btn_modal_circle_coming_soon_hide() { var x = document.getElementById('modal_circle_gas_info'); x.className = 'd-none'; } function show_hide_td(nn) { var x; var id = "tr"+nn; x = document.getElementById(id); if(!x.classList.contains("d-none")) { x.classList.add("d-none"); } else { x.classList.remove("d-none"); } } function coming_soon_show() { } function api_circle_stat(id) { console.log("api_circle_stat: "+id); var pos; var airdrop; var circle; var tarif; var url; var wal; var x; var flag; var func; pos = id.indexOf("_"); airdrop = id.substr(0,pos); circle = id.substr(pos+1); x = document.getElementById("modal_circle_tarif_id"); tarif = x.innerHTML; if(!selectedAccount)return false; wal = selectedAccount; if(glob["tarif_addr_list"][tarif] === undefined) { flag = 0; } else { if(glob["tarif_addr_list"][tarif])flag = 1; else flag = 0; } if(!flag)return false; url = glob["api-dap"]+"api/stat/"+airdrop+"/"+wal+"/"+tarif+"/"+circle; func = "api_circle_stat_view(xhr.response);"; ajax_get_data(url,func); } function api_circle_stat_view(res) { var res2 = JSON.parse(res); modal_circle_detail_tbl(res2["result"]); } async function web3_sign_wallet_download() { var x; var name; var msg; var tarif; var params = "";; x = document.getElementById("modal_circle_tarif_id"); tarif = x.innerHTML; name = "Confirm request to download wallets\n"; name += "wallet: "+selectedAccount+"\n"; name += "tarif: "+tarif+"\n"; name += "time: "+getCurrentTimestamp()+"\n"; msg = name; name = "<pre>"+name+"</pre>"; modal_tx_info_open(name); var prov_now = get_web3_prov(); var prov_type1 = prov_type(prov_now); try { const from = selectedAccount; var sign; if (prov_type1 == "wc") { sign = await WagmiCore.signMessage( { message: msg } ); } else { sign = await ethereum.request({ method: 'personal_sign', params: [msg, from], }); } params += "sign="+sign; params += "&addr="+from; params += "&msg="+encodeURIComponent(msg); url = glob["api-dap"]+"wldl/"; console.log(url); ajax_post_data(url,params,"wallet_download_sign_link(xhr.response);"); console.log("'"+msg+"'"); } catch (e) { err = web3_error_parse(e); x = document.getElementById('modal_txs_info_err'); x.innerHTML = err; x = document.getElementById('modal_txs_info_btn'); x.innerHTML = 'Sign message error'; } } function wallet_download_sign_link(p) { var x; params = JSON.parse(p); if(params.status == 1) { x = document.getElementById('modal_txs_info_btn'); x.innerHTML = 'Click to download'; x.disabled = false; glob["modal_txs_link"] = params.result; } else { x = document.getElementById('modal_txs_info_err'); x.innerHTML = params.error; x = document.getElementById('modal_txs_info_btn'); x.innerHTML = 'Sign message error'; x.disabled = true; } } function ga_dataLayer_push(evnt = "deposit",name,amount=0,comments="",hash="") { window.dataLayer = window.dataLayer || []; var m = new Object(); m.event = evnt; m.name = name; m.qty = amount; m.value = amount; m.comments = comments; m.hash = hash; console.log(m); window.dataLayer.push(m); log("GA push sended"); } function web3_error_parse(e) { var prov_now = get_web3_prov(); var prov_type1 = prov_type(prov_now); var err = ""; var t; var wal = get_cookie("selectedAccount"); var e2 = JSON.stringify(e); var o = new Object(); var name = get_function_name(arguments.callee.toString()); o.wal = wal; o.prov = prov_now; o.err = e2; web_log(name,o); t = e; switch(prov_type1) { case "wc": if(!err && t.error.message !== undefined) { err = t.error.message; } if(!err && t.code !== undefined) { switch(t.code+"") { case "4001": err = "Canceled by user in WalletConnect"; break; default: err = "WalletConnect error: "+t.code; } } break; default: console.log("!!!!!!!!!!!!"); if(t.code !== undefined) { switch(t.code+"") { case "4001": err = "Canceled by user in wallet: "+prov_now;; break; case "-32603": err = prov_now+": error code "+t.code; if(t.message !== undefined) err = prov_now+": "+t.message; if(t.data.message !== undefined) err = prov_now+": "+t.data.message; break; default: err = "Transaction error: "+t.code+" on wallet: "+prov_now; } } if(err == "") { if(t.data !== undefined) { err = t.data.message; } else err = t.message; pos = err.indexOf("("); if(pos > 0) err = err.substr(0,pos); switch(err) { case "MetaMask Tx Signature: User denied transaction signature.": case "Tx Signature: User denied transaction signature.": case "MetaMask Message Signature: User denied message signature.": case "MetaMask Personal Message Signature: User denied message signature.": case "Message Signature: User denied message signature.": case "Personal Message Signature: User denied message signature.": err = "Transaction canceled in wallet: "+prov_now; break; } } } err = err.replace("execution reverted: ",""); err = err.replace(".",".<br>\n"); return err; } function web_log(name,o) { var api_url; var wal = get_cookie("selectedAccount"); api_url = glob["api-dap"] + "web_log/"+name+"/"+wal; params = str = JSON.stringify(o); ajax_post_data(api_url, params, web_log_res); } function web_log_res(res) { console.log(res); } function token_mas(net) { var c_mas = new Array(); switch(net) { case "fork": c_mas["usdc"] = "0x3Fe765E7bf1197A61B79348bbb5cE1076f41f85D"; c_mas["usdt"] = "0xDBA3137E2D74E66e5e785FA87F554962d65c00cf"; c_mas["dai"] = "0x151c418c2911EF51E95521740eB342432b22b32E"; c_mas["eth"] = "0x4E22C60c9b25E07f1bd13b2fD26A27F06a3bB330"; break; case "mumbai": c_mas["usdc"] = "0xfc33dad01925B6074C8be4b90CfA70EEF0352a6A"; c_mas["usdt"] = "0x6DA4c6217F86A824B570C757E764711950aAb3CA"; c_mas["dai"] = "0xE14F092611b5726Bb79A471eaf76C2ab3165fd88"; c_mas["eth"] = "0x8486770AF10f191fFb8dc268FCb7E297D1416947"; break; case "matic": c_mas["usdc"] = "0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"; c_mas["usdt"] = "0xc2132D05D31c914a87C6611C10748AEb04B58e8F"; c_mas["dai"] = "0x8f3Cf7ad23Cd3CaDbD9735AFf958023239c6A063"; c_mas["eth"] = "0x7ceB23fD6bC0adD59E62ac25578270cFf1b9f619"; c_mas["matic"] = "0x0d500B1d8E8eF31E21C99d1Db9A6444d3ADf1270"; break; case "eth": c_mas["usdc"] = "0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"; c_mas["usdt"] = "0xdAC17F958D2ee523a2206206994597C13D831ec7"; c_mas["dai"] = "0x6B175474E89094C44Da98b954EedeAC495271d0F"; break; case "bsc": c_mas["usdc"] = "0x8AC76a51cc950d9822D68b83fE1Ad97B32Cd580d"; c_mas["usdt"] = "0x55d398326f99059fF775485246999027B3197955"; c_mas["dai"] = "0x1AF3F329e8BE154074D8769D1FFa4eE058B1DBc3"; break; } return c_mas; } async function web3_ref_nick_get() { c = glob["contracts"]["matic_ref_register"]; ref_register = new web3mas["matic"].eth.Contract(eth_abi["ref_register"], c); ref_register.methods.NickGet(selectedAccount).call(function (err, res) { if (err) { console.log("An error occurred", err); return; } if(res)glob["nick"][selectedAccount] = res; console.log("Nick: '"+res+"'"); }); } async function web3_access_balance_allowance(net) { var n; var x; var o = new Array(); var txt = ""; var l; var c = glob["contracts"][net+"_access"]; var contract = new web3mas[net].eth.Contract(eth_abi["access"], c); if(!selectedAccount)return false; contract.methods.CheckBalanceAllowance(selectedAccount,c).call(function (err, res) { if (err) { console.log("An error occurred"); console.log(err); return; } n = "usdc"; x = document.getElementById(net+"_b_"+n); x.innerHTML = res["b_"+n]; x = document.getElementById(net+"_a_"+n); x.innerHTML = res["a_"+n]; glob["balance"][net+"_b_"+n] = res["b_"+n]; glob["balance"][net+"_a_"+n] = res["a_"+n]; n = "usdt"; x = document.getElementById(net+"_b_"+n); x.innerHTML = res["b_"+n]; x = document.getElementById(net+"_a_"+n); x.innerHTML = res["a_"+n]; glob["balance"][net+"_b_"+n] = res["b_"+n]; glob["balance"][net+"_a_"+n] = res["a_"+n]; n = "dai"; x = document.getElementById(net+"_b_"+n); x.innerHTML = res["b_"+n]; x = document.getElementById(net+"_a_"+n); x.innerHTML = res["a_"+n]; glob["balance"][net+"_b_"+n] = res["b_"+n]; glob["balance"][net+"_a_"+n] = res["a_"+n]; x = document.getElementById(net+"_cost"); x.innerHTML = res["cost"]; glob["balance"][net+"_cost"] = res["cost"]; glob["balance"][net+"_whitelisted"] = res["whitelisted"]; x = document.getElementById(net+"_whitelisted"); x.innerHTML = res["whitelisted"]; }) } async function web3_whitelists_balance(net) { var c = glob["contracts"]["white_list_"+net]; const contract = new web3mas[net].eth.Contract(eth_abi["ref_balance"], c); if(!selectedAccount)return false; contract.methods.Balance(selectedAccount).call(function (err, res) { if (err) { console.log("An error occurred"); console.log(err); return; } n = "access_balance_"+net; set_by_className(n,res); glob["access_balance"][net] = res*1; setTimeout(access_balance_summary,300); }) } async function web3_ref_balance(net) { var c = glob["contracts"][net+"_ref_balance"]; var n; const contract = new web3mas[net].eth.Contract(eth_abi["ref_balance"], c); if(!selectedAccount)return false; contract.methods.Balance(selectedAccount).call(function (err, res) { if (err) { console.log("An error occurred"); console.log(err); return; } n = "ref_balance_"+net; set_by_className(n,res); }) } async function web3_tarif_addr_list(net) { var v; var koef; switch(net) { case "matic": koef = 1; break; case "bsc": koef = 2; break; } var id; var i; var l; var c = glob["contracts"]["buy_tarif_"+net]; var n; const contract = new web3mas[net].eth.Contract(eth_abi["buy_tarif"], c); if(!selectedAccount)return false; contract.methods.TarifAddrList(selectedAccount).call(function (err, res) { if (err) { console.log("An error occurred"); console.log(err); return; } l = res[0].length; if(l>0) for(i=0;i<l;i++) { id = res[0][i]; if(id==0)continue; id = 'blk_tarif_'+id; x = document.getElementById(id); if(x !== null) { glob["tarif_addr_list2"][net][res[0][i]] = res[1][i]; v = glob["tarif_addr_list2"]["matic"][res[0][i]]; v += glob["tarif_addr_list2"]["bsc"][res[0][i]]; glob["tarif_addr_list"][res[0][i]] = v?true:false; if(v > 0) { x.className = 'buyed'; } else { x.className = 'nobuyed'; } } } }) } async function web3_factory_user_clone_tarif_addr(tarif,flag = 0) { var net = glob["circle_net"]; var c = glob["contracts"]["factory_"+net]; const contract = new web3mas[net].eth.Contract(eth_abi["factory"], c); if(!selectedAccount)return false; contract.methods.UserClone(selectedAccount,tarif).call(function (err, res) { if (err) { console.log("An error occurred"); console.log(err); return; } console.log("!!!! Factory cloned addr: "+res); if(flag) web3_clone_process(tarif,res); }) } async function web3_factory_status() { console.log("Get function: web3_factory_status"); if(!selectedAccount)return false; var tkn; var id; var t; var x; var net; var c; var contract; var abi; x = document.getElementById('modal_circle_tarif_id'); var tarif = x.innerHTML*1; x = document.getElementById('modal_circle_airdrop_id2'); var airdrop = x.innerHTML*1; x = document.getElementById('modal_circle_num'); var circle = x.innerHTML*1; console.log("Tarif: "+tarif+" circle: "+circle+" Airdrop: "+airdrop); id = airdrop+"_"+circle; switch(airdrop+"") { case "1": net = glob["circle_net"]; c = glob["contracts"]["factory_"+net]; abi = eth_abi["factory"]; contract = new web3mas[net].eth.Contract(abi, c); contract.methods.Status(selectedAccount,tarif,circle).call(function (err, res){if (err){console.log("An error occurred");console.log(err);return;};factory_status_set(res);}); break; case "4": net = "bsc"; console.log("circle: "+circle); switch(circle+"") { case "5": c = glob["contracts"]["factory_info2_"+net]; break; default: c = glob["contracts"]["factory_info_"+net]; } abi = eth_abi["factory_info"]; contract = new web3mas[net].eth.Contract(abi, c); contract.methods.Status(selectedAccount,tarif,circle).call(function (err, res){if (err){console.log("An error occurred");console.log(err);return;};factory_status_set(res);}); break; case "5": case "7": net = glob["factory3_net"]; c = glob["contracts"]["factory3_"+net]; abi = eth_abi["factory3"]; contract = new web3mas[net].eth.Contract(abi, c); contract.methods.Status(selectedAccount,tarif,circle).call(function (err, res){if (err){console.log("An error occurred");console.log(err);return;};factory_status_set(res);}); break; case "10": net = "bsc"; c = glob["contracts"]["factory3_"+net]; abi = eth_abi["factory3"]; contract = new web3mas[net].eth.Contract(abi, c); contract.methods.Status(selectedAccount,tarif,circle).call(function (err, res){if (err){console.log("An error occurred");console.log(err);return;};factory_status_set(res);}); break; case "12": net = "bsc"; c = glob["contracts"]["distribute_nodes_"+net]; abi = eth_abi["distribute_nodes"]; contract = new web3mas[net].eth.Contract(abi, c); contract.methods.Status(selectedAccount,tarif,circle).call(function (err, res){if (err){console.log("An error occurred");console.log(err);return;};factory_status_set(res);}); break; default: net = "bsc"; tkn = "0x55d398326f99059fF775485246999027B3197955"; c = glob["contracts"]["factory2_"+net]; abi = eth_abi["factory2"]; contract = new web3mas[net].eth.Contract(abi, c); console.log("net: "+net+" contract: "+c); contract.methods.Status2(selectedAccount,tarif,circle,tkn).call(function (err, res){if (err){console.log("An error occurred");console.log(err);return;};factory_status_set(res);}); } } function factory_status_set(res) { var v; var x; var decimal = 18; console.log(res); if(res.decimal !== undefined)decimal = res.decimal; x = document.getElementById("modal_circle_inited"); x.innerHTML = res.inited; x = document.getElementById("modal_circle_cost"); v = res.cost / 10**18; switch(v+"") { case "99999.99999999999": v = "100000"; break; case "49999.99999999999": v = "50000"; break; case "39999.99999999999": v = "40000"; break; } x.innerHTML = v; x = document.getElementById("modal_circle_distributed"); x.innerHTML = res.distributed; x = document.getElementById("modal_circle_c_addr"); x.innerHTML = res.c_addr; x = document.getElementById("modal_circle_balance"); x.innerHTML = res.balance / 10**decimal; x = document.getElementById("modal_circle_approve"); if(res.approve !== undefined) x.innerHTML = res.approve; else x.innerHTML = "false"; } async function web3_refill2_CheckBalanceAllowance(net) { var n; var x; var o = new Array(); var txt = ""; var l; var c = glob["contracts"]["refill2_"+net]; var contract = new web3mas[net].eth.Contract(eth_abi["refill"], c); if(!selectedAccount)return false; contract.methods.CheckBalanceAllowance(selectedAccount,c).call(function (err, res) { if (err) { console.log("An error occurred"); console.log(err); return; } if(1) { n = "usdc"; x = document.getElementById("r_"+net+"_b_"+n); x.innerHTML = res["b_"+n]; x = document.getElementById("r_"+net+"_a_"+n); x.innerHTML = res["a_"+n]; glob["balance"][net+"_b_"+n] = res["b_"+n]; glob["balance"][net+"_a_"+n] = res["a_"+n]; glob["balance"][net+"_d_"+n] = res["d_"+n]; n = "usdt"; x = document.getElementById("r_"+net+"_b_"+n); x.innerHTML = res["b_"+n]; x = document.getElementById("r_"+net+"_a_"+n); x.innerHTML = res["a_"+n]; glob["balance"][net+"_b_"+n] = res["b_"+n]; glob["balance"][net+"_a_"+n] = res["a_"+n]; glob["balance"][net+"_d_"+n] = res["d_"+n]; n = "dai"; x = document.getElementById("r_"+net+"_b_"+n); x.innerHTML = res["b_"+n]; x = document.getElementById("r_"+net+"_a_"+n); x.innerHTML = res["a_"+n]; glob["balance"][net+"_b_"+n] = res["b_"+n]; glob["balance"][net+"_a_"+n] = res["a_"+n]; glob["balance"][net+"_d_"+n] = res["d_"+n]; glob["balance"][net+"_whitelisted"] = res["whitelisted"]; glob["balance"][net+"_ref"] = res["ref"]; } }) } async function web3_refill_CheckBalanceAllowance(net) { var n; var x; var o = new Array(); var txt = ""; var l; var c = glob["contracts"]["refill_"+net]; var contract = new web3mas[net].eth.Contract(eth_abi["refill"], c); if(!selectedAccount)return false; contract.methods.CheckBalanceAllowance(selectedAccount,c).call(function (err, res) { if (err) { console.log("An error occurred"); console.log(err); return; } if(1) { n = "usdc"; x = document.getElementById("r_"+net+"_b_"+n); x.innerHTML = res["b_"+n]; x = document.getElementById("r_"+net+"_a_"+n); x.innerHTML = res["a_"+n]; glob["balance"][net+"_b_"+n] = res["b_"+n]; glob["balance"][net+"_a_"+n] = res["a_"+n]; glob["balance"][net+"_d_"+n] = res["d_"+n]; n = "usdt"; x = document.getElementById("r_"+net+"_b_"+n); x.innerHTML = res["b_"+n]; x = document.getElementById("r_"+net+"_a_"+n); x.innerHTML = res["a_"+n]; glob["balance"][net+"_b_"+n] = res["b_"+n]; glob["balance"][net+"_a_"+n] = res["a_"+n]; glob["balance"][net+"_d_"+n] = res["d_"+n]; n = "dai"; x = document.getElementById("r_"+net+"_b_"+n); x.innerHTML = res["b_"+n]; x = document.getElementById("r_"+net+"_a_"+n); x.innerHTML = res["a_"+n]; glob["balance"][net+"_b_"+n] = res["b_"+n]; glob["balance"][net+"_a_"+n] = res["a_"+n]; glob["balance"][net+"_d_"+n] = res["d_"+n]; glob["balance"][net+"_whitelisted"] = res["whitelisted"]; glob["balance"][net+"_ref"] = res["ref"]; } }) } async function web3_circle_cost(id) { var n; var x; var v; var txt = ""; var l; var pos; var net; var tarif; var decimal; var airdrop; var circle; pos = id.indexOf("_"); airdrop = id.substr(0,pos); circle = id.substr(pos+1); x = document.getElementById("modal_circle_tarif_id"); tarif = x.innerHTML; switch(airdrop) { case "1": net = "eth"; decimal = 18; break; case "2": case "3": net = "bsc"; decimal = 18; break; case "4": net = "bsc"; decimal = 18; break; case "5": case "7": case "8": net = glob["factory3_net"]; decimal = 18; break; case "10": net = "bsc"; decimal = 18; break; case "12": net = "bsc"; decimal = 18; break; } var c = glob["contracts"]["circle_"+net]; var contract = new web3mas[net].eth.Contract(eth_abi["circle"], c); contract.methods.CostGet(tarif,circle).call(function (err, res) { if (err) { console.log("An error occurred"); console.log(err); return; } v = res / 10**decimal; switch(v+"") { case "99999.99999999999": v = "100000"; break; case "49999.99999999999": v = "50000"; break; case "39999.99999999999": v = "40000"; break; } x = document.getElementById("modal_circle_cost_summary_"+id); x.innerHTML = v; }); } glob["governance"]["admin"] = false; async function web3_gov_is_admin() { var t; var x; var net = glob["gov_net"]; var c = glob["contracts"]["gov_"+net]; var contract = new web3mas[net].eth.Contract(eth_abi["governance"], c); contract.methods.IsAdmin(selectedAccount).call(function (err, res) { if (err) { console.log("An error occurred"); console.log(err); return; } glob["governance"]["admin"] = res; x = document.getElementById("gov_new_pos"); t = "btn btn-primary btn-rad10 btn-sm"; if(res == true && x.className != t) { x.className = t; glob["governance"]["update_time"] = ""; } if(res == false && x.className != "d-none") { x.className = "d-none"; glob["governance"]["update_time"] = ""; } }); } async function web3_gov_balance() { var d; var n; var x; var v; var i; var l; var k; var net = glob["gov_net"]; var c = glob["contracts"]["gov_"+net]; var contract = new web3mas[net].eth.Contract(eth_abi["governance"], c); var tkns = new Array(); var atkns = new Array(); tkns = token_mas(net); atkns[0] = tkns["usdc"]; atkns[1] = tkns["usdt"]; atkns[2] = tkns["dai"]; atkns[3] = tkns["eth"]; contract.methods.WalInfo(selectedAccount,atkns).call(function (err, res) { if (err) { console.log("An error occurred"); console.log(err); return; } l = res[3].length; for(i=0;i<l;i++) { v = res[3][i]; v = v.toLowerCase(v); v = v.replace("dev",""); v = v.replace("weth","eth"); n = v; b = res[2][i]; x = document.getElementById("gov_"+net+"_b_"+n); v = res[0][i]; v /= 10**b; if(x.innerHTML != v) x.innerHTML = v; x = document.getElementById("gov_"+net+"_a_"+n); v = res[1][i]; v /= 10**b; if(x.innerHTML != v) x.innerHTML = v; x = document.getElementById("gov_"+net+"_d_"+n); if(x.innerHTML != b) x.innerHTML = b; } }); } glob["governance"]["update_time"] = ""; async function web3_gov_update_time() { var t; var x; var net = glob["gov_net"]; var c = glob["contracts"]["gov_"+net]; var contract = new web3mas[net].eth.Contract(eth_abi["governance"], c); contract.methods.UpdateTime().call(function (err, res) { if (err) { console.log("An error occurred"); console.log(err); return; } if(glob["governance"]["update_time"] != res) { glob["governance"]["update_time"] = res; console.log("NEED LOAD REWARDS LIST: "+utime_to_localtime(res)); web3_gov_reward_list(); } }); } async function web3_gov_reward_list() { var o; var i; var l; var t; var x; var net = glob["gov_net"]; var c = glob["contracts"]["gov_"+net]; var contract = new web3mas[net].eth.Contract(eth_abi["governance"], c); contract.methods.RewList().call(function (err, res) { if (err) { console.log("An error occurred"); console.log(err); return; } console.log(res); l = res[0]; o = gov_rew_list_tbl(l,res); x = document.getElementById("gov_tbl"); x.innerHTML = o; setTimeout(web3_gov_claim_list_addr,100); }); } async function web3_gov_claim_list_addr() { var o; var i; var l; var t; var x; var y; var v; var part; var all; var id; var d; var claimed; var net = glob["gov_net"]; var c = glob["contracts"]["gov_"+net]; var contract = new web3mas[net].eth.Contract(eth_abi["governance"], c); contract.methods.ClaimListAddr(selectedAccount).call(function (err, res) { if (err) { console.log("An error occurred"); console.log(err); return; } console.log(res); l = res[0]; for(i=0;i<l;i++) { id = i+1; x = document.getElementById('gov_decimal_'+id); if(x === undefined || x === null)continue; d = x.innerHTML; claimed = res[2][i]/10**d; if(claimed > 0) { x = document.getElementById('gov_my_claimed_'+id); x.innerHTML = claimed; x = document.getElementById('gov_my_amount_'+id); x.innerHTML = "-"; } else { x = document.getElementById('gov_rew_amount_'+id); all = x.innerHTML; part = res[5][i]/res[4][i]; v = part * all; x = document.getElementById('gov_my_amount_'+id); x.innerHTML = v; } } }); } glob["ref_balance"] = new Array(); glob["ref_balance"]["update_time_bsc"] = 0; glob["ref_balance"]["update_time_matic"] = 0; async function web3_ref_balance_update_time(net) { var t; var x; var c = glob["contracts"]["ref_balance_"+net]; var contract = new web3mas[net].eth.Contract(eth_abi["ref_balance"], c); contract.methods.UpdateTime().call(function (err, res) { if (err) { console.log("An error occurred"); console.log(err); return; } if(glob["ref_balance"]["update_time_"+net] != res) { glob["ref_balance"]["update_time_"+net] = res; console.log("NEED LOAD INVITE LIST on "+net+": "+utime_to_localtime(res)); web3_ref_balance_list(net); } }); } async function web3_ref_balance_list(net) { console.log("web3_ref_balance_list - Net: "+net); var c = glob["contracts"]["ref_info_"+net]; var contract = new web3mas[net].eth.Contract(eth_abi["ref_info"], c); contract.methods.RefList().call(function (err, res) { if (err) { console.log("An error occurred"); console.log(err); return; } console.log(res); }); } async function web3_get_balances() { var usd = 0; var net = "matic"; var tkn_mas = token_mas(net); var nn = 0; var wrap; var addrs = new Array(); var directions = new Array(); var tkns = new Array(); var stable; var router = "0x0000000000000000000000000000000000000000"; var factory = "0x0000000000000000000000000000000000000000"; var rate_type = 1; var direction = false; console.log("web3_get_balances"); var c = glob["contracts"]["folio_"+net]; console.log("contract: "+c); var contract = new web3mas[net].eth.Contract(eth_abi["folio"], c); switch(net) { case "mumbai": addrs[0] = "0x036F0293412EA3f8e51ef3D6010604BbD81580F6"; addrs[1] = "0x847C5E34747a18D409A2E293E05B3d7e587f2EBb"; addrs[2] = "0xF91cA7ed5B55aF215a403B6da82649cEc38c930b"; tkns[0] = "0xee5A3D04D2E52Fbc4FA92545994ba3eA82e4e9E1"; tkns[1] = "0x79C38FADF5CcaA45BeD12962650885296f0B2494"; stable[0] = "0x79C38FADF5CcaA45BeD12962650885296f0B2494"; break; case "matic": addrs[nn++] = "0x036F0293412EA3f8e51ef3D6010604BbD81580F6"; addrs[nn++] = "0x847C5E34747a18D409A2E293E05B3d7e587f2EBb"; addrs[nn++] = "0xF91cA7ed5B55aF215a403B6da82649cEc38c930b"; addrs[nn++] = "0x93ed2b63fde6bc95b21b566935c7b1cf0c57d8c4"; addrs[nn++] = "0x56d539f7fd807beab37323edd862868a98a4163e"; addrs[nn++] = "0x76e6115db963c1f1ff54d48bdaaef0807dda70c6"; addrs[nn++] = "0xd6ecf7c1d100cb4fc1a7faddce7e9c85c012ecd2"; addrs[nn++] = "0xe2e11a3aeb2e03d1eaca9e2c3691eae664d530e7"; addrs[nn++] = "0x7d2c313bbc918c78351a5a381742f3cabc84ec11"; addrs[nn++] = "0x07b060779c4ab2c9a42c6e38b0a0e5da5b07b30a"; addrs[nn++] = "0x437b9be6c59f4fc559ed63c46a5c024139c679cb"; addrs[nn++] = "0xa24191f6c50fc5004b2903aeb4be56d34cea2a7e"; addrs[nn++] = "0x8d4cb11a6ddaf79018b89efd8662a96a38395d05"; addrs[nn++] = "0x506671acbbd3c46d6de5273b8a3c2b61945b16cd"; addrs[nn++] = "0x2f58f35cba7cec3c7b60542b84291b1ce350a2f0"; addrs[nn++] = "0x667f975c6a53839d774ef150b6bc3fb36c06ebf7"; addrs[nn++] = "0x39302257ced2fe60beded13627c643b08797cd92"; addrs[nn++] = "0x5650810c78556f93e48395db64ec454d7ffc156c"; addrs[nn++] = "0x8226f575b3a1c0284c44ee333e9adc0178494ca9"; addrs[nn++] = "0x64aa18dea173609150b55c099c6d8698d4477e1d"; addrs[nn++] = "0xd3ed6bcc13985220eb58b31ac45ed7a9c6ebe48d"; addrs[nn++] = "0x4ad2679ece31c663aa1f8d8ad708aaddfafc0730"; addrs[nn++] = "0xc44c1c8731f04689933ef888c4c3e128404600b0"; addrs[nn++] = "0xd3dad158fb547bbbdd8d1fc80579a57939eb6f4e"; addrs[nn++] = "0x791436ccbec46d68ede8a2f2f5361a687c73b168"; addrs[nn++] = "0xda0da854355fa18ee17a08f8c8ff1e7eeaa3a095"; addrs[nn++] = "0xdb61ed6de72a4052819a2fc8cdef4a96aba85abc"; addrs[nn++] = "0xa45a88680e895944c6be2064283bea8dc0faad87"; addrs[nn++] = "0xa9fbfb92d381d6f934fff6cd5fe12ab33e29fe31"; addrs[nn++] = "0x14456babd03d497999d8433f64a144b17d151d3f"; addrs[nn++] = "0xf91b4282729c394af5a2a2a3899ba23291620e38"; addrs[nn++] = "0x1f7e6b359abe1334f1eb5a9ea0d4e99ca0e3b660"; addrs[nn++] = "0x4ef6a4edea96311833e5656a7d431bcc8237fd35"; addrs[nn++] = "0x13ef082c8e53635f8e380582a68f96c2f6e07e41"; addrs[nn++] = "0x2ef1184b9a363c191823b0ba5591db5ed59af97c"; addrs[nn++] = "0xe15129604c314a032b3895583701274b1d7119a2"; addrs[nn++] = "0x354ca9a39fabf90936c15fa860e40c688568c3a3"; addrs[nn++] = "0x709026ca4edb3e16a78173ca9fa5ec7ade8042e8"; addrs[nn++] = "0x53e380c2b4aa41864f81d373cc247beb7e305388"; addrs[nn++] = "0xc0957053f5975ee0a6155c2a86725c0a76c540f0"; addrs[nn++] = "0x3957791f3b366c1e4cc580538cc268791f8c0302"; addrs[nn++] = "0x8245d67b985cb456eff9812e68c6eac7d562bcff"; addrs[nn++] = "0x0adc66c86d71a19fa06c3b2115213f3b40cf20be"; addrs[nn++] = "0xaa4b4ae444ba8d8d60fefce7b9ef465fc9232607"; addrs[nn++] = "0x84128863db1d56c4a204cb11570772c39a410cf5"; addrs[nn++] = "0xe6597c7ecdd9b472636c2ac22d8571e63d07d849"; addrs[nn++] = "0xc38bd5c648b6536bc067ef2dde6df6473ccc8a49"; addrs[nn++] = "0x0d5953b2b53badd81b224330b590b4944be08b13"; addrs[nn++] = "0xcdff059a716cb677b1d54bff7b9e8e14271cd34e"; addrs[nn++] = "0x784c931b1942308954eeeaf6c0675e3783c4d9c7"; addrs[nn++] = "0xc6894768649b7f1ffa7f366cf6c2e3802ca49da8"; addrs[nn++] = "0xd0dfa94e08f4497aed5b8e0a15f2be79437611a4"; addrs[nn++] = "0xb4fae961ffb948860dcbe971a94fddc026fadebb"; addrs[nn++] = "0x74e79dec4d323fc15dc5bbcea624156e0e28d37d"; addrs[nn++] = "0xfb15676b3fa6871cf3229abc5dfb9dba59308896"; addrs[nn++] = "0x5b0b377916f4737dd33775b0656e4acb0761f960"; addrs[nn++] = "0xb0c62d33ae1810ac38cd1dbee441b4ea71bb7366"; addrs[nn++] = "0xc9b71fad27e1e108e5e38582b1d75cac59d7f4d2"; console.log("NN contract: "+nn); nn = 0; tkns[nn] = tkn_mas["usdc"];	directions[nn] = false;	nn++; tkns[nn] = tkn_mas["usdt"];	directions[nn] = false;	nn++; tkns[nn] = tkn_mas["dai"];	directions[nn] = false;	nn++; tkns[nn] = tkn_mas["eth"];	directions[nn] = false;	nn++; tkns[nn] = tkn_mas["matic"];	directions[nn] = false;	nn++; wrap = "0x0d500B1d8E8eF31E21C99d1Db9A6444d3ADf1270"; router = "0xa5E0829CaCEd8fFDD4De3c43696c57F7D7A678ff"; factory = "0x5757371414417b8C6CAad45bAeF941aBc7d3Ab32"; break; } contract.methods.Info(addrs,tkns,wrap,factory,rate_type,direction,directions).call(function (err, res) { if (err) { console.log("An error occurred"); console.log(err); return; } console.log(res); usd = res[0]; usd /= 10**18; console.log("USD: "+usd); }); } async function web3_ref_claim_get100_GetMessage(item,id,code) { var net = 'bsc'; var c = glob["contracts"]["ref_claim_get100_"+net]; var contract = new web3mas[net].eth.Contract(eth_abi["ref_claim_get100"], c); contract.methods.GetMessage(item,id,code).call(function (err, res) { if (err) { console.log("An error occurred"); console.log(err); return; } console.log(res); }); } async function web3_ref_claim_get100_GetSign(item) { console.log('web3_ref_claim_get100_GetSign'); var code = ""; var err_txt = ""; var o = new Object(); var f = false; api_url = glob["api-dap"] + "web3_get100/"; switch(item+"") { case "1": code = localStorage.getItem('get100_eml'); break; case "2": code = localStorage.getItem('get100_twr'); break; case "3": code = localStorage.getItem('get100_twr'); break; case "4": code = localStorage.getItem('get100_tlg'); break; } if(code == null) { code = ""; } if(code == "" || code.length != 12) { err_txt = switch_item_err_txt(item); x = document.getElementById('get100_info'); x.innerHTML = err_txt; setTimeout(hide_get100_info,1000); return false; } o.item = item; o.wal = selectedAccount; o.code = code; params = JSON.stringify(o); console.log(params); params = btoa(params); console.log("Go: "+api_url); ajax_post_data(api_url, params, "web3_ref_claim_get100_GetSign_res(xhr.response);"); } function switch_item_err_txt(item) { var err_txt = "Undefined error"; switch(item+"") { case "1": err_txt = "You have not confirmed your email"; break; case "2": err_txt = "You have not connected your twitter"; break; case "3": err_txt = "You have not retweeted specified tweet"; break; case "4": err_txt = "Coming soon"; break; } return err_txt; } function web3_ref_claim_get100_GetSign_res(res) { var o = new Object(); res = atob(res); o = JSON.parse(res); console.log(o); if(o.status == 0) { err_txt = switch_item_err_txt(o.item); x = document.getElementById('get100_info'); x.innerHTML = err_txt; setTimeout(hide_get100_info,1000); return false; } web3_ref_claim_get100(o.item,o.id,o.code,o.sign); } async function web3_ref_claim_get100_CheckSign(item,id,code) { var sign = glob["web3_get100_sign"]; var net = 'bsc'; var c = glob["contracts"]["ref_claim_get100_"+net]; var contract = new web3mas[net].eth.Contract(eth_abi["ref_claim_get100"], c); contract.methods.Sign(item,id,code,sign).call(function (err, res) { if (err) { console.log("An error occurred"); console.log(err); return; } console.log(res); }); } async function web3_ref_claim_get100_ClamedByWal() { var net = 'bsc'; var c = glob["contracts"]["ref_claim_get100_"+net]; if(!selectedAccount)return false; var wal = selectedAccount; var contract = new web3mas[net].eth.Contract(eth_abi["ref_claim_get100"], c); contract.methods.ClaimedByWal(wal).call(function (err, res) { if (err) { console.log("An error occurred"); console.log(err); return; } complete_status_show(res); }); } function complete_status_show(o) { var txt = ""; var v; var t = 0; var e; var x; x = document.getElementById('complete_status'); var claimed_steps = []; for(i=1;i<5;i++) { e = "v = o.i"+i+";"; eval(e); t += v?1:0; if (v) { claimed_steps.push(i); if (i == get_cookie("get100_item")) { var claimed_btn = document.getElementById("btn_claim_get100"); var claimed_btn_class = "art-button-3 btn btn-primary btn-sm claim-btn green-btn"; var claimed_btn_txt = "Claimed"; claimed_btn.innerHTML = claimed_btn_txt; claimed_btn.className = claimed_btn_class; } } } set_cookie("get100_claimed", claimed_steps); txt = ""; txt += "Claimed: $"+(t*25); txt += " ("+t+"/4)"; if(x.innerHTML != txt) x.innerHTML = txt; } function hide_get100_info() { var x; x = document.getElementById('get100_info'); x.innerHTML = "&nbsp;"; } async function web3_ref_register() { var gas; var x; var contractAddr = glob["contracts"]["matic_ref_register"]; var nick = ''; var name = ''; const signer2 = await get_signer2(); console.log("Contract address: "+contractAddr); var wal = selectedAccount; if(!wal) return false; const cContract = new ethers.Contract(contractAddr, eth_abi["ref_register"], signer2); x = document.getElementById("iref_nick"); nick = x.value; name = "Register nick '"+nick+"'"; console.log("902 nick :"+nick); modal_tx_info_open(name); try { var options = {value: ethers.utils.parseEther("10")}; r = await cContract.NickRegister(nick,options); if(r) { x = document.getElementById('modal_txs_info_id'); x.innerHTML = r.hash; console.log(r); x = document.getElementById('modal_txs_info_btn'); x.innerHTML = 'View in Explorer'; x.disabled = 0; } } catch(e) { console.log(e); err = web3_error_parse(e); x = document.getElementById('modal_txs_info_err'); x.innerHTML = err; x = document.getElementById('modal_txs_info_btn'); x.innerHTML = 'Transaction error'; console.log(t); } } async function web3_access_allowance(amount,coin,net) { var c_mas = new Array(); c_mas = token_mas(net); var c = glob["contracts"][net+"_access"]; var tkn = c_mas[coin]; var name = ''; const signer2 = await get_signer2(); console.log("Contract token: "+tkn); var wal = selectedAccount; if(!wal) return false; const contract = new ethers.Contract(tkn, eth_abi["token"], signer2); name = "Approve "+amount+" "+coin; amount = "10000000000000000000000000000000000000000000000000"; modal_tx_info_open(name); try { r = await contract.approve(c,amount); if(r) { console.log("sended OK"); x = document.getElementById('modal_txs_info_id'); x.innerHTML = r.hash; console.log(r); x = document.getElementById('modal_txs_info_btn'); x.innerHTML = 'View in Explorer'; x.disabled = 0; } } catch(e) { err = web3_error_parse(e); x = document.getElementById('modal_txs_info_err'); x.innerHTML = err; x = document.getElementById('modal_txs_info_btn'); x.innerHTML = 'Transaction error'; console.log(t); } } async function web3_access_GetAccess(net,coin) { var ref_addr; var x; var c_mas = new Array(); c_mas = token_mas(net); var tkn = c_mas[coin]; console.log("Tkn: "+tkn); var contractAddr = glob["contracts"][net+"_access"]; const signer2 = await get_signer2(); console.log("Contract address: "+contractAddr); var wal = selectedAccount; if(!wal) return false; const contract = new ethers.Contract(contractAddr, eth_abi["access"], signer2); x = get_cookie("ref_wal"); ref_addr = x; if(!x) ref_addr = "0x93ED2B63fdE6BC95b21B566935c7B1Cf0C57d8C4"; if(x.toLowerCase() == wal.toLowerCase()) ref_addr = "0x93ED2B63fdE6BC95b21B566935c7B1Cf0C57d8C4"; console.log("Ref: "+ref_addr); name = "Get access by token "+coin; modal_tx_info_open(name); try { r = await contract.GetAccess(ref_addr,tkn); if(r) { x = document.getElementById('modal_txs_info_id'); x.innerHTML = r.hash; console.log(r); x = document.getElementById('modal_txs_info_btn'); x.innerHTML = 'View in Explorer'; x.disabled = 0; } } catch(e) { err = web3_error_parse(e); x = document.getElementById('modal_txs_info_err'); x.innerHTML = err; x = document.getElementById('modal_txs_info_btn'); x.innerHTML = 'Transaction error'; console.log(t); } } async function web3_buy_tarif(net) { var cost; var tarif; var tarif_name; var airdrop_name; var x; var c_mas = new Array(); c_mas = token_mas(net); var contractAddr = glob["contracts"]["buy_tarif_"+net]; const signer2 = await get_signer2(); console.log("Contract address: "+contractAddr); var wal = selectedAccount; if(!wal) return false; const contract = new ethers.Contract(contractAddr, eth_abi["buy_tarif"], signer2); x = document.getElementById('buy_tarif_cost'); cost = x.innerHTML; x = document.getElementById('buy_tarif_airdrop_name'); airdrop_name = x.innerHTML; x = document.getElementById('buy_tarif_name'); tarif_name = x.innerHTML; x = document.getElementById('buy_tarif_id'); tarif = x.innerHTML; name = "Buy tarif '"+tarif_name+"' in possible AirDrop "+airdrop_name+""; modal_tx_info_open(name); try { r = await contract.TarifBuy(tarif); if(r) { x = document.getElementById('modal_txs_info_id'); x.innerHTML = r.hash; console.log(r); x = document.getElementById('modal_txs_info_btn'); x.innerHTML = 'View in Explorer'; x.disabled = 0; } } catch(e) { err = web3_error_parse(e); x = document.getElementById('modal_txs_info_err'); x.innerHTML = err; x = document.getElementById('modal_txs_info_btn'); x.innerHTML = 'Transaction error'; console.log(t); } } async function web3_factory_init(tarif) { console.log('web3_factory_init'); var net = glob["circle_net"]; var contractAddr = glob["contracts"]["factory_"+net]; const signer2 = await get_signer2(); console.log("Contract address: "+contractAddr); var wal = selectedAccount; if(!wal) return false; const contract = new ethers.Contract(contractAddr, eth_abi["factory"], signer2); name = "Init test tariff "+tarif; var addrs = new Array(); var nn=0; addrs[nn++] = "0x280ba57e2c0885e500eb1ce71f0713d7d30980ef"; addrs[nn++] = "a7a9665f1d5f53d2d778b74e3d5f43205115657b"; addrs[nn++] = "5d63e71d43649cc52b1889184c8dcd3d8f641369"; addrs[nn++] = "2122ad4a77ca7542a637d94b1f48d36845b56cc3"; addrs[nn++] = "97026d9bde49dc64ce705ef82e4f28a243aee523"; addrs[nn++] = "050dd6a7575fe640ac32fbba329f32a80195227f"; addrs[nn++] = "ad81fc1bec1b5fbd9fda9eaa6a8a275add0e1f98"; addrs[nn++] = "c6229151b7457f24aa766aac7f0e35d41b725e66"; addrs[nn++] = "6cfb98d54990daff2ccb52b5a9b44286df531999"; addrs[nn++] = "38b47a3b714c238c9e8080760bc8fe7c5889c717"; modal_tx_info_open(name); try { r = await contract.Init(tarif,addrs); if(r) { x = document.getElementById('modal_txs_info_id'); x.innerHTML = r.hash; console.log(r); x = document.getElementById('modal_txs_info_btn'); x.innerHTML = 'View in Explorer'; x.disabled = 0; } } catch(e) { err = web3_error_parse(e); x = document.getElementById('modal_txs_info_err'); x.innerHTML = err; x = document.getElementById('modal_txs_info_btn'); x.innerHTML = 'Transaction error'; console.log(t); } } async function web3_clone_process(tarif,contractAddr) { var net = 'eth'; var circle = 1; console.log("Tarif: "+tarif); if(contractAddr == "0x0000000000000000000000000000000000000000") { console.log("Tariff for this user not inited"); return false; } console.log("Contract address: "+contractAddr); const signer2 = await get_signer2(); var wal = selectedAccount; if(!wal) return false; const contract = new ethers.Contract(contractAddr, eth_abi["clone"], signer2); name = "Process"; modal_tx_info_open(name); try { const options = {value: ethers.utils.parseEther("0.005")}; console.log(options); console.log("tariff: "+tarif); console.log("circle: "+circle); r = await contract.Process(tarif,circle,options); if(r) { x = document.getElementById('modal_txs_info_id'); x.innerHTML = r.hash; console.log(r); x = document.getElementById('modal_txs_info_btn'); x.innerHTML = 'View in Explorer'; x.disabled = 0; } } catch(e) { err = web3_error_parse(e); x = document.getElementById('modal_txs_info_err'); x.innerHTML = err; x = document.getElementById('modal_txs_info_btn'); x.innerHTML = 'Transaction error'; console.log(t); } } async function web3_circle_init(circle) { var gas; var l; var clone_num = 2; var tarif; var tarif_name; var t; var x; var net = glob["circle_net"]; var c = glob["contracts"]["factory_"+net]; if(!selectedAccount)return false; const signer2 = await get_signer2(); var wal = selectedAccount; if(!wal) return false; x = document.getElementById("modal_circle_tarif_id"); tarif = x.innerHTML; switch(tarif) { case "6": clone_num = 3; break; } x = document.getElementById("modal_circle_tarif_name"); tarif_name = x.innerHTML; const contract = new ethers.Contract(c, eth_abi["factory"], signer2); name = "Init tarrif accounts ("+tarif_name+")"; console.log("tariff: "+tarif); console.log(glob["tarif_wallet_list"]); modal_tx_info_open(name); l = glob["tarif_wallet_list"].length; if(l == 0 || l === undefined) { err = "Error loading tariff wallets<br>"; err += "Address: "+wal+"<br>"; err += "Number of wallet: "+l+"<br>"; err += "Reload page and try again"; x = document.getElementById('modal_txs_info_err'); x.innerHTML = err; x = document.getElementById('modal_txs_info_btn'); x.innerHTML = 'Transaction error'; return false; } try { gas = await contract.estimateGas.Init(tarif,glob["tarif_wallet_list"],clone_num); console.log("Gas: "+gas); var options = {gasLimit: Math.ceil(gas*1.2)}; r = await contract.Init(tarif,glob["tarif_wallet_list"],clone_num,options); if(r) { x = document.getElementById('modal_txs_info_id'); x.innerHTML = r.hash; console.log(r); x = document.getElementById('modal_txs_info_btn'); x.innerHTML = 'View in Explorer'; x.disabled = 0; setInterval(web3_factory_status,15000); } } catch(e) { err = web3_error_parse(e); x = document.getElementById('modal_txs_info_err'); x.innerHTML = err; x = document.getElementById('modal_txs_info_btn'); x.innerHTML = 'Transaction error'; console.log(t); } } async function web3_circle_distribute(circle) { var gas; var cost; var tarif; var tarif_name; var t; var x; var net = glob["circle_net"]; x = document.getElementById("modal_circle_c_addr"); var c = x.innerHTML; if(0) { var router = "0xa5E0829CaCEd8fFDD4De3c43696c57F7D7A678ff"; var router = "0x1b02dA8Cb0d097eB8D57A175b88c7D8b47997506"; var token = "0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"; var base = "0x0d500b1d8e8ef31e21c99d1db9a6444d3adf1270"; } else { var router = "0x7a250d5630B4cF539739dF2C5dAcb4c659F2488D"; var token = "0xa0b86991c6218b36c1d19d4a2e9eb0ce3606eb48"; var base = "0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2"; } var debug = 0; if(!selectedAccount)return false; const signer2 = await get_signer2(); var wal = selectedAccount; if(!wal) return false; x = document.getElementById("modal_circle_cost"); cost = x.innerHTML; x = document.getElementById("modal_circle_tarif_id"); tarif = x.innerHTML; x = document.getElementById("modal_circle_tarif_name"); tarif_name = x.innerHTML; const contract = new ethers.Contract(c, eth_abi["clone"], signer2); name = "Distribute ETH into you tariff accounts"; modal_tx_info_open(name); try { var options = {value: ethers.utils.parseEther(cost)}; gas = await contract.estimateGas.Process(tarif,circle,router,token,base,debug,options);; console.log("Gas: "+gas); options = {value: ethers.utils.parseEther(cost),gasLimit: Math.ceil(gas*1.2)}; r = await contract.Process(tarif,circle,router,token,base,debug,options); if(r) { x = document.getElementById('modal_txs_info_id'); x.innerHTML = r.hash; console.log(r); x = document.getElementById('modal_txs_info_btn'); x.innerHTML = 'View in Explorer'; x.disabled = 0; setInterval(web3_factory_status,15000); } } catch(e) { err = web3_error_parse(e); x = document.getElementById('modal_txs_info_err'); x.innerHTML = err; x = document.getElementById('modal_txs_info_btn'); x.innerHTML = 'Transaction error'; console.log(t); } } async function web3_test2() { var c = glob["contracts"]["test2_matic"]; console.log(c); if(!selectedAccount)return false; const signer2 = await get_signer2(); var wal = selectedAccount; if(!wal) return false; name = "Test2"; const contract = new ethers.Contract(c, eth_abi["test2"], signer2); modal_tx_info_open(name); var router = "0xa5E0829CaCEd8fFDD4De3c43696c57F7D7A678ff"; var token = "0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"; var base = "0x0d500b1d8e8ef31e21c99d1db9a6444d3adf1270"; var tarif = 0; var circle = 0; try { const options = {value: ethers.utils.parseEther("10")}; r = await contract.Process(tarif,circle,router,token,base,0,options); if(r) { x = document.getElementById('modal_txs_info_id'); x.innerHTML = r.hash; console.log(r); x = document.getElementById('modal_txs_info_btn'); x.innerHTML = 'View in Explorer'; x.disabled = 0; } } catch(e) { err = web3_error_parse(e); x = document.getElementById('modal_txs_info_err'); x.innerHTML = err; x = document.getElementById('modal_txs_info_btn'); x.innerHTML = 'Transaction error'; console.log(t); } } async function web3_refill_approve(amount,coin,net,decimal) { var c_mas = new Array(); c_mas = token_mas(net); var amount2; var c = glob["contracts"]["refill_"+net]; var tkn = c_mas[coin]; var name = ''; const signer2 = await get_signer2(); console.log("Contract token: "+tkn); var wal = selectedAccount; if(!wal) return false; const contract = new ethers.Contract(tkn, eth_abi["token"], signer2); name = "Approve "+amount+" "+coin; amount2 = BigInt(amount * 10**decimal); amount2 = ""+amount2; console.log("Amount2: "+amount2); modal_tx_info_open(name); try { r = await contract.approve(c,amount2); if(r) { console.log("sended OK"); x = document.getElementById('modal_txs_info_id'); x.innerHTML = r.hash; console.log(r); x = document.getElementById('modal_txs_info_btn'); x.innerHTML = 'View in Explorer'; x.disabled = 0; } } catch(e) { err = web3_error_parse(e); x = document.getElementById('modal_txs_info_err'); x.innerHTML = err; x = document.getElementById('modal_txs_info_btn'); x.innerHTML = 'Transaction error'; console.log(t); } } async function web3_refill2_approve(amount,coin,net,decimal) { var c_mas = new Array(); c_mas = token_mas(net); var amount2; var c = glob["contracts"]["refill2_"+net]; var tkn = c_mas[coin]; var name = ''; const signer2 = await get_signer2(); console.log("Contract token: "+tkn); var wal = selectedAccount; if(!wal) return false; const contract = new ethers.Contract(tkn, eth_abi["token"], signer2); name = "Approve "+amount+" "+coin; amount2 = new ethers.BigNumber.from(amount).mul(ethers.BigNumber.from(10).pow(decimal)); console.log("Amount2: "+amount2); modal_tx_info_open(name); try { r = await contract.approve(c,amount2); if(r) { console.log("sended OK"); x = document.getElementById('modal_txs_info_id'); x.innerHTML = r.hash; console.log(r); x = document.getElementById('modal_txs_info_btn'); x.innerHTML = 'View in Explorer'; x.disabled = 0; } } catch(e) { err = web3_error_parse(e); x = document.getElementById('modal_txs_info_err'); x.innerHTML = err; x = document.getElementById('modal_txs_info_btn'); x.innerHTML = 'Transaction error'; console.log(t); } } async function web3_refill_pay(net,coin,amount) { var ref_addr; var x; var c_mas = new Array(); c_mas = token_mas(net); var tkn = c_mas[coin]; console.log("Tkn: "+tkn); var contractAddr = glob["contracts"]["refill_"+net]; const signer2 = await get_signer2(); console.log("Contract address: "+contractAddr); var wal = selectedAccount; if(!wal) return false; const contract = new ethers.Contract(contractAddr, eth_abi["refill"], signer2); x = get_cookie("ref_wal"); ref_addr = x; if(!ref_addr) ref_addr = "0x93ED2B63fdE6BC95b21B566935c7B1Cf0C57d8C4"; if(ref_addr.toLowerCase() == wal.toLowerCase()) ref_addr = "0x93ED2B63fdE6BC95b21B566935c7B1Cf0C57d8C4"; console.log("Ref: "+ref_addr); console.log("Tkn: "+tkn); console.log("Amount: "+amount); name = "Pay "+amount+" "+coin+" into access balance"; console.log(name); modal_tx_info_open(name); try { r = await contract.Pay(ref_addr,tkn,amount); if(r) { x = document.getElementById('modal_txs_info_id'); x.innerHTML = r.hash; console.log(r); x = document.getElementById('modal_txs_info_btn'); x.innerHTML = 'View in Explorer'; x.disabled = 0; } } catch(e) { err = web3_error_parse(e); x = document.getElementById('modal_txs_info_err'); x.innerHTML = err; x = document.getElementById('modal_txs_info_btn'); x.innerHTML = 'Transaction error'; console.log(t); } } async function web3_refill2_pay(net,coin,amount) { var data; var debug = 0; var ref_addr; var x; var c_mas = new Array(); c_mas = token_mas(net); var tkn = c_mas[coin]; console.log("Tkn: "+tkn); var contractAddr = glob["contracts"]["refill2_"+net]; const signer2 = await get_signer2(); console.log("Contract address: "+contractAddr); var wal = selectedAccount; if(!wal) return false; const contract = new ethers.Contract(contractAddr, eth_abi["refill2"], signer2); x = get_cookie("ref_wal"); ref_addr = x; if(!ref_addr) ref_addr = glob["ah_ref_addr"]; if(ref_addr.toLowerCase() == wal.toLowerCase()) ref_addr = glob["ah_ref_addr"]; console.log("Ref: "+ref_addr); console.log("Tkn: "+tkn); console.log("Amount: "+amount); name = "Pay "+amount+" "+coin+" into access balance"; console.log(name); modal_tx_info_open(name); try { console.log("Debug: "+debug); data = contract.interface.encodeFunctionData('Pay', [ref_addr,tkn,amount,debug]); console.log("Data: "+data); gas = await contract.estimateGas.Pay(ref_addr,tkn,amount,debug); console.log("Gas: "+gas); console.log("From: "+wal); console.log("To: "+contractAddr); r = await contract.Pay(ref_addr,tkn,amount,debug); if(r) { log("Check prod: "+glob["prod"]); x = document.getElementById('modal_txs_info_id'); x.innerHTML = r.hash; console.log(r); x = document.getElementById('modal_txs_info_btn'); x.innerHTML = 'View in Explorer'; x.disabled = 0; if(glob["prod"]) { ga_dataLayer_push("deposit",name+" ["+net+"]",amount,"",r.hash); log("NEED ga_dataLayer_push"); } } } catch(e) { err = web3_error_parse(e); x = document.getElementById('modal_txs_info_err'); x.innerHTML = err; x = document.getElementById('modal_txs_info_btn'); x.innerHTML = 'Transaction error'; console.log(t); } } async function web3_circle_init_v02(id) { var gas; var l; var clone_num = 2; var tarif; var tarif_name; var t; var x; var pos; var airdrop; var tarif; var circle; var net; var c; var abi; console.log("ID: "+id); pos = id.indexOf("_"); airdrop = id.substr(0,pos); console.log("Airdrop: "+airdrop); circle = id.substr(pos+1); x = document.getElementById("modal_circle_tarif_id"); tarif = x.innerHTML; switch(airdrop) { case "1": net = "eth"; decimal = 18; c = glob["contracts"]["factory_"+net]; abi = eth_abi["factory"]; break; case "2": case "3": net = "bsc"; decimal = 18; c = glob["contracts"]["factory2_"+net]; clone_num = 4; abi = eth_abi["factory2"]; break; case "4": net = "bsc"; decimal = 18; c = glob["contracts"]["factory2_"+net]; clone_num = 6; abi = eth_abi["factory2"]; break; } switch(tarif) { case "16": clone_num = 5; break; case "23": break; } if(!selectedAccount)return false; const signer2 = await get_signer2(); var wal = selectedAccount; if(!wal) return false; switch(tarif) { case "6": clone_num = 3; break; } x = document.getElementById("modal_circle_tarif_name"); tarif_name = x.innerHTML; const contract = new ethers.Contract(c, abi, signer2); name = "Init tariff accounts ("+tarif_name+")"; console.log("tariff: "+tarif); console.log(glob["tarif_wallet_list"]); modal_tx_info_open(name); l = glob["tarif_wallet_list"].length; if(l == 0 || l === undefined) { err = "Error loading tariff wallets<br>"; err += "Address: "+wal+"<br>"; err += "Number of wallet: "+l+"<br>"; err += "Reload page and try again"; x = document.getElementById('modal_txs_info_err'); x.innerHTML = err; x = document.getElementById('modal_txs_info_btn'); x.innerHTML = 'Transaction error'; return false; } try { console.log("Clone_num: "+clone_num); gas = await contract.estimateGas.Init(tarif,glob["tarif_wallet_list"],clone_num); console.log("Gas: "+gas); var options = {gasLimit: Math.ceil(gas*1.2)}; r = await contract.Init(tarif,glob["tarif_wallet_list"],clone_num,options); if(r) { x = document.getElementById('modal_txs_info_id'); x.innerHTML = r.hash; console.log(r); x = document.getElementById('modal_txs_info_btn'); x.innerHTML = 'View in Explorer'; x.disabled = 0; setTimeout(web3_factory_status,15000); setTimeout(web3_factory_status,60000); } } catch(e) { err = web3_error_parse(e); x = document.getElementById('modal_txs_info_err'); x.innerHTML = err; x = document.getElementById('modal_txs_info_btn'); x.innerHTML = 'Transaction error'; console.log(t); } } async function web3_circle_distribute_v02(circle) { var gas; var cost; var tarif; var tarif_name; var t; var x; var net = "bsc"; x = document.getElementById("modal_circle_c_addr"); var c = x.innerHTML; var router = "0x10ED43C718714eb63d5aA57B78B54704E256024E"; var token = "0x55d398326f99059fF775485246999027B3197955"; var base = "0xbb4CdB9CBd36B01bD1cBaEBF2De08d9173bc095c"; var debug = 0; if(!selectedAccount)return false; const signer2 = await get_signer2(); var wal = selectedAccount; if(!wal) return false; x = document.getElementById("modal_circle_cost"); cost = x.innerHTML; x = document.getElementById("modal_circle_tarif_id"); tarif = x.innerHTML; x = document.getElementById("modal_circle_tarif_name"); tarif_name = x.innerHTML; const contract = new ethers.Contract(c, eth_abi["clone"], signer2); name = "Distribute BNB from USDT into you tariff accounts"; console.log("Contract: "+c); console.log("tarif: "+tarif); console.log("Circle: "+circle); console.log("Router: "+router); console.log("Base: "+base); modal_tx_info_open(name); try { var options = {}; gas = await contract.estimateGas.Process(tarif,circle,router,token,base,debug,options); console.log("Gas: "+gas); options = {gasLimit: Math.ceil(gas*1.2)}; r = await contract.Process(tarif,circle,router,token,base,debug,options); if(r) { x = document.getElementById('modal_txs_info_id'); x.innerHTML = r.hash; console.log(r); x = document.getElementById('modal_txs_info_btn'); x.innerHTML = 'View in Explorer'; x.disabled = 0; setTimeout(web3_factory_status,15000); } } catch(e) { err = web3_error_parse(e); x = document.getElementById('modal_txs_info_err'); x.innerHTML = err; x = document.getElementById('modal_txs_info_btn'); x.innerHTML = 'Transaction error'; console.log(t); } } async function web3_distribute_approve() { var net = "bsc"; var c_mas = new Array(); c_mas = token_mas(net); var amount2; var coin = "usdt"; var x; var c; x = document.getElementById("modal_circle_c_addr"); c = x.innerHTML; console.log("Contract: "+c); var tkn = c_mas[coin]; var name = ''; const signer2 = await get_signer2(); console.log("Contract token: "+tkn); var wal = selectedAccount; if(!wal) return false; const contract = new ethers.Contract(tkn, eth_abi["token"], signer2); name = "Approve "+coin+" to distribute"; amount2 = "10000000000000000000000000000000000000000000000000"; modal_tx_info_open(name); try { r = await contract.approve(c,amount2); if(r) { console.log("sended OK"); x = document.getElementById('modal_txs_info_id'); x.innerHTML = r.hash; console.log(r); x = document.getElementById('modal_txs_info_btn'); x.innerHTML = 'View in Explorer'; x.disabled = 0; setInterval(web3_factory_status,15000); setInterval(web3_factory_status,60000); } } catch(e) { err = web3_error_parse(e); x = document.getElementById('modal_txs_info_err'); x.innerHTML = err; x = document.getElementById('modal_txs_info_btn'); x.innerHTML = 'Transaction error'; console.log(t); } } async function web3_circle_distribute_v03(circle) { var pers = 90; var gas; var cost; var tarif; var tarif_name; var t; var x; var net = "bsc"; x = document.getElementById("modal_circle_c_addr"); var c = x.innerHTML; var debug = 0; if(!selectedAccount)return false; const signer2 = await get_signer2(); var wal = selectedAccount; if(!wal) return false; x = document.getElementById("modal_circle_cost"); cost = x.innerHTML; x = document.getElementById("modal_circle_tarif_id"); tarif = x.innerHTML; switch(tarif) { case "23": pers = 85; break; } x = document.getElementById("modal_circle_tarif_name"); tarif_name = x.innerHTML; const contract = new ethers.Contract(c, eth_abi["clone6"], signer2); name = "Distribute BNB into you tariff accounts"; console.log("Contract: "+c); console.log("tarif: "+tarif); console.log("Circle: "+circle); console.log("Cost: "+cost); console.log("Debug: "+debug); console.log("Pers: "+pers); modal_tx_info_open(name); try { var options = {value: ethers.utils.parseEther(cost)}; gas = await contract.estimateGas.Process(tarif,circle,pers,debug,options); console.log("Gas: "+gas); options = {gasLimit: Math.ceil(gas*1.2),value: ethers.utils.parseEther(cost)}; r = await contract.Process(tarif,circle,pers,debug,options); if(r) { x = document.getElementById('modal_txs_info_id'); x.innerHTML = r.hash; console.log(r); x = document.getElementById('modal_txs_info_btn'); x.innerHTML = 'View in Explorer'; x.disabled = 0; setTimeout(web3_factory_status,15000); } } catch(e) { err = web3_error_parse(e); x = document.getElementById('modal_txs_info_err'); x.innerHTML = err; x = document.getElementById('modal_txs_info_btn'); x.innerHTML = 'Transaction error'; console.log(t); } } async function web3_gov_approve(net,tkn) { var amount; var d; var x; var a; var c_mas = new Array(); c_mas = token_mas(net); var c = glob["contracts"]["gov_"+net]; const signer2 = await get_signer2(); var wal = selectedAccount; if(!wal) return false; x = document.getElementById("gov_"+net+"_i_"+tkn); a = x.value; a *= 1; x = document.getElementById("gov_"+net+"_d_"+tkn); d = x.innerHTML; amount = a * 10**d; amount = BigInt(amount); amount += ""; const contract = new ethers.Contract(c_mas[tkn], eth_abi["token"], signer2); name = "Approve "+a+" "+tkn.toUpperCase()+" to deposit"; modal_tx_info_open(name); try { r = await contract.approve(c,amount); if(r) { console.log("sended OK"); x = document.getElementById('modal_txs_info_id'); x.innerHTML = r.hash; console.log(r); x = document.getElementById('modal_txs_info_btn'); x.innerHTML = 'View in Explorer'; x.disabled = 0; } } catch(e) { err = web3_error_parse(e); x = document.getElementById('modal_txs_info_err'); x.innerHTML = err; x = document.getElementById('modal_txs_info_btn'); x.innerHTML = 'Transaction error'; console.log(t); } } async function web3_gov_deposit(net,tkn) { var snap = 0; var debug = 0; var c_mas = new Array(); c_mas = token_mas(net); var c = glob["contracts"]["gov_"+net]; const signer2 = await get_signer2(); console.log("Contract: "+c); var wal = selectedAccount; if(!wal) return false; x = document.getElementById("gov_"+net+"_i_"+tkn); a = x.value; a *= 1; x = document.getElementById("gov_"+net+"_d_"+tkn); d = x.innerHTML; amount = a * 10**d; amount = BigInt(amount); amount += ""; const contract = new ethers.Contract(c, eth_abi["governance"], signer2); name = "Deposit "+a+" "+tkn.toUpperCase()+" to rewards"; modal_tx_info_open(name); try { gas = await contract.estimateGas.Deposit(c_mas[tkn],amount,snap,debug); console.log("Gas: "+gas); var options = {gasLimit: Math.ceil(gas*1.2)}; console.log("Deposit Amount: "+amount); r = await contract.Deposit(c_mas[tkn],amount,debug,snap,options); if(r) { x = document.getElementById('modal_txs_info_id'); x.innerHTML = r.hash; console.log(r); x = document.getElementById('modal_txs_info_btn'); x.innerHTML = 'View in Explorer'; x.disabled = 0; } } catch(e) { err = web3_error_parse(e); x = document.getElementById('modal_txs_info_err'); x.innerHTML = err; x = document.getElementById('modal_txs_info_btn'); x.innerHTML = 'Transaction error'; console.log(t); } } async function web3_gov_claim(rew) { var net = glob["gov_net"]; console.log("web3_gov_claim()"); if(!selectedAccount || !glob['onConnected']) { onConnect(); setTimeout(web3_gov_claim,500,rew); return false; } var c = glob["contracts"]["gov_"+net]; const signer2 = await get_signer2(); console.log("Contract: "+c); var wal = selectedAccount; if(!wal) return false; const contract = new ethers.Contract(c, eth_abi["governance"], signer2); name = "Claim rewards: "+rew; modal_tx_info_open(name); try { console.log("Rew: "+rew); gas = await contract.estimateGas.Claim(selectedAccount,rew); console.log("Gas: "+gas); var options = {gasLimit: Math.ceil(gas*1.2)}; r = await contract.Claim(selectedAccount,rew,options); if(r) { x = document.getElementById('modal_txs_info_id'); x.innerHTML = r.hash; console.log(r); x = document.getElementById('modal_txs_info_btn'); x.innerHTML = 'View in Explorer'; x.disabled = 0; } } catch(e) { err = web3_error_parse(e); x = document.getElementById('modal_txs_info_err'); x.innerHTML = err; x = document.getElementById('modal_txs_info_btn'); x.innerHTML = 'Transaction error'; console.log(t); } } async function web3_gov_withdraw(rew) { var net = glob["gov_net"]; console.log("web3_gov_withdraw()"); if(!selectedAccount || !glob['onConnected']) { onConnect(); setTimeout(web3_gov_withdraw,500,rew); return false; } var c = glob["contracts"]["gov_"+net]; const signer2 = await get_signer2(); console.log("Contract: "+c); var wal = selectedAccount; if(!wal) return false; const contract = new ethers.Contract(c, eth_abi["governance"], signer2); name = "Withdraw rewards: "+rew; modal_tx_info_open(name); try { console.log("Rew: "+rew); gas = await contract.estimateGas.Withdraw(rew); console.log("Gas: "+gas); var options = {gasLimit: Math.ceil(gas*1.2)}; r = await contract.Withdraw(rew,options); if(r) { x = document.getElementById('modal_txs_info_id'); x.innerHTML = r.hash; console.log(r); x = document.getElementById('modal_txs_info_btn'); x.innerHTML = 'View in Explorer'; x.disabled = 0; } } catch(e) { err = web3_error_parse(e); x = document.getElementById('modal_txs_info_err'); x.innerHTML = err; x = document.getElementById('modal_txs_info_btn'); x.innerHTML = 'Transaction error'; console.log(t); } } async function web3_gov_rew_show_hide(rew) { var net = glob["gov_net"]; console.log("web3_gov_withdraw()"); if(!selectedAccount || !glob['onConnected']) { onConnect(); setTimeout(web3_gov_rew_show_hide,500,rew); return false; } var c = glob["contracts"]["gov_"+net]; const signer2 = await get_signer2(); console.log("Contract: "+c); var wal = selectedAccount; if(!wal) return false; const contract = new ethers.Contract(c, eth_abi["governance"], signer2); name = "Show/Hide rewards: "+rew; modal_tx_info_open(name); try { console.log("Rew: "+rew); gas = await contract.estimateGas.RewardShowHide(rew); console.log("Gas: "+gas); var options = {gasLimit: Math.ceil(gas*1.2)}; r = await contract.RewardShowHide(rew,options); if(r) { x = document.getElementById('modal_txs_info_id'); x.innerHTML = r.hash; console.log(r); x = document.getElementById('modal_txs_info_btn'); x.innerHTML = 'View in Explorer'; x.disabled = 0; } } catch(e) { err = web3_error_parse(e); x = document.getElementById('modal_txs_info_err'); x.innerHTML = err; x = document.getElementById('modal_txs_info_btn'); x.innerHTML = 'Transaction error'; console.log(t); } } async function web3_circle_init_v03(id) { var gas; var l; var clone_num = 2; var tarif; var tarif_name; var t; var x; var pos; var airdrop; var tarif; var circle; var net; var c; var abi; console.log("ID: "+id); pos = id.indexOf("_"); airdrop = id.substr(0,pos); console.log("Airdrop: "+airdrop); circle = id.substr(pos+1); x = document.getElementById("modal_circle_tarif_id"); tarif = x.innerHTML; switch(airdrop) { case "4": net = "bsc"; decimal = 18; c = glob["contracts"]["factory3_"+net]; clone_num = 8; abi = eth_abi["factory3"]; break; case "5": case "7": case "8": net = glob["factory3_net"]; decimal = 18; c = glob["contracts"]["factory3_"+net]; clone_num = 8; abi = eth_abi["factory3"]; break; case "10": net = "bsc"; decimal = 18; c = glob["contracts"]["factory3_"+net]; clone_num = 8; abi = eth_abi["factory3"]; break; } console.log("Clone_num: "+clone_num); if(!selectedAccount)return false; const signer2 = await get_signer2(); var wal = selectedAccount; if(!wal) return false; x = document.getElementById("modal_circle_tarif_name"); tarif_name = x.innerHTML; const contract = new ethers.Contract(c, abi, signer2); name = "Init tariff accounts ("+tarif_name+")"; console.log("tariff: "+tarif); modal_tx_info_open(name); try { console.log("Clone_num: "+clone_num); gas = await contract.estimateGas.Init(tarif,circle,clone_num); console.log("Gas: "+gas); var options = {gasLimit: Math.ceil(gas*1.2)}; r = await contract.Init(tarif,circle,clone_num,options); if(r) { x = document.getElementById('modal_txs_info_id'); x.innerHTML = r.hash; console.log(r); x = document.getElementById('modal_txs_info_btn'); x.innerHTML = 'View in Explorer'; x.disabled = 0; setTimeout(web3_factory_status,15000); setTimeout(web3_factory_status,60000); } } catch(e) { err = web3_error_parse(e); x = document.getElementById('modal_txs_info_err'); x.innerHTML = err; x = document.getElementById('modal_txs_info_btn'); x.innerHTML = 'Transaction error'; console.log(t); } } async function web3_circle_distribute_v04(circle,net2="") { var cname; var pers = 90; var gas; var cost; var tarif; var tarif_name; var t; var x; var l; var net; if(net2 == "") net = glob["factory3_net"]; else net = net2; x = document.getElementById("modal_circle_c_addr"); var c = x.innerHTML; var debug = 0; if(!selectedAccount)return false; const signer2 = await get_signer2(); var wal = selectedAccount; if(!wal) return false; x = document.getElementById("modal_circle_cost"); cost = x.innerHTML; x = document.getElementById("modal_circle_tarif_id"); tarif = x.innerHTML; switch(tarif) { case "31": case "23": case "50": case "64": pers = 85; break; } x = document.getElementById("modal_circle_tarif_name"); tarif_name = x.innerHTML; const contract = new ethers.Contract(c, eth_abi["clone8"], signer2); l = glob["tarif_wallet_list"].length; if(l == 0 || l === undefined) { err = "Error loading tariff wallets<br>"; err += "Address: "+wal+"<br>"; err += "Number of wallet: "+l+"<br>"; err += "Reload page and try again"; x = document.getElementById('modal_txs_info_err'); x.innerHTML = err; x = document.getElementById('modal_txs_info_btn'); x.innerHTML = 'Transaction error'; return false; } switch(net) { case "eth": cname = "ETH"; break; case "bsc": cname = "BNB"; break; default: cname = "COIN"; } name = "Distribute "+cost+" "+cname+" into you tariff accounts ["+l+" wallets]"; console.log("Contract: "+c); console.log("tarif: "+tarif); console.log("Circle: "+circle); console.log("Cost: "+cost); console.log("Debug: "+debug); console.log("Pers: "+pers); modal_tx_info_open(name); try { var options = {value: ethers.utils.parseEther(cost)}; gas = await contract.estimateGas.Process(tarif,circle,pers,glob["tarif_wallet_list"],debug,options); console.log("Gas: "+gas); options = {gasLimit: Math.ceil(gas*1.2),value: ethers.utils.parseEther(cost)}; r = await contract.Process(tarif,circle,pers,glob["tarif_wallet_list"],debug,options); if(r) { x = document.getElementById('modal_txs_info_id'); x.innerHTML = r.hash; console.log(r); x = document.getElementById('modal_txs_info_btn'); x.innerHTML = 'View in Explorer'; x.disabled = 0; setTimeout(web3_factory_status,15000); } } catch(e) { err = web3_error_parse(e); x = document.getElementById('modal_txs_info_err'); x.innerHTML = err; x = document.getElementById('modal_txs_info_btn'); x.innerHTML = 'Transaction error'; console.log(t); } } async function web3_ref_claim20(net="bsc",cost=20) { var cname; var o = new Object(); o.name = whoCallsMe2(); var t; var x; var l; var ref; var c = glob["contracts"]["ref_claim20_"+net]; var debug = 0; const signer2 = await get_signer2(); var wal = selectedAccount; if(!wal) return false; const contract = new ethers.Contract(c, eth_abi["ref_claim20"], signer2); ref = get_cookie("ref_wal"); name = "Claim \$"+cost+" into you DEPOSIT"; console.log("Ref: "+ref); modal_tx_info_open(name); o.txt = name; try { console.log("From: "+wal); console.log("To: "+c); data = contract.interface.encodeFunctionData('Claim', [ref]); console.log("Data: "+data); o.from = wal; o.to = c; o.data	= data; web_log(o.name,o); gas = await contract.estimateGas.Claim(ref); console.log("Gas: "+gas); options = {gasLimit: Math.ceil(gas*1.2)}; r = await contract.Claim(ref,options); if(r) { x = document.getElementById('modal_txs_info_id'); x.innerHTML = r.hash; console.log(r); x = document.getElementById('modal_txs_info_btn'); x.innerHTML = 'View in Explorer'; x.disabled = 0; setTimeout(web3_factory_status,15000); } } catch(e) { err = web3_error_parse(e); x = document.getElementById('modal_txs_info_err'); x.innerHTML = err; x = document.getElementById('modal_txs_info_btn'); x.innerHTML = 'Transaction error'; console.log(t); } } async function web3_ref_claim_get100(item,id,code,signature) { var net = "bsc"; var cost = 25; var cname; var o = new Object(); o.name = whoCallsMe2(); var t; var x; var l; var ref; var c = glob["contracts"]["ref_claim_get100_"+net]; var debug = 0; const signer2 = await get_signer2(); var wal = selectedAccount; if(!wal) return false; const contract = new ethers.Contract(c, eth_abi["ref_claim_get100"], signer2); ref = get_cookie("ref_wal"); if(!ref)ref = glob["ah_ref_addr"]; switch(item+"") { case "1": cname = "for your email subscribe"; break; case "2": cname = "for twitter following"; break; case "3": cname = "for retweet"; break; case "4": cname = "for your telegram subscribe"; break; } name = "Claim \$"+cost+": "+cname; console.log("Contract: "+c); console.log("id: "+id); console.log("item: "+item); console.log("Ref: "+ref); console.log("sign: "+signature); modal_tx_info_open(name); o.txt = name; try { console.log("From: "+wal); console.log("To: "+c); data = contract.interface.encodeFunctionData('Claim', [item,id,code,ref,signature]); console.log("Data: "+data); o.from = wal; o.to = c; o.data	= data; web_log(o.name,o); gas = await contract.estimateGas.Claim(item,id,code,ref,signature); console.log("Gas: "+gas); options = {gasLimit: Math.ceil(gas*1.2)}; r = await contract.Claim(item,id,code,ref,signature,options); if(r) { x = document.getElementById('modal_txs_info_id'); x.innerHTML = r.hash; console.log(r); x = document.getElementById('modal_txs_info_btn'); x.innerHTML = 'View in Explorer'; x.disabled = 0; setTimeout(web3_factory_status,15000); } } catch(e) { err = web3_error_parse(e); x = document.getElementById('modal_txs_info_err'); x.innerHTML = err; x = document.getElementById('modal_txs_info_btn'); x.innerHTML = 'Transaction error'; console.log(t); } } async function web3_distribute_node_approve() { var net = "bsc"; var c_mas = new Array(); c_mas = token_mas(net); var amount2; var coin = "usdt"; var decimal = 18; var amount; var x; var c; x = document.getElementById("modal_circle_cost"); amount = x.innerHTML; x = document.getElementById("modal_circle_c_addr"); c = x.innerHTML; console.log("Contract: "+c); var tkn = c_mas[coin]; var name = ''; const signer2 = await get_signer2(); console.log("Contract token: "+tkn); var wal = selectedAccount; if(!wal) return false; const contract = new ethers.Contract(tkn, eth_abi["token"], signer2); name = "Approve "+amount+" "+coin+" to distribute"; amount2 = new ethers.BigNumber.from(amount).mul(ethers.BigNumber.from(10).pow(decimal)); modal_tx_info_open(name); try { r = await contract.approve(c,amount2); if(r) { console.log("sended OK"); x = document.getElementById('modal_txs_info_id'); x.innerHTML = r.hash; console.log(r); x = document.getElementById('modal_txs_info_btn'); x.innerHTML = 'View in Explorer'; x.disabled = 0; setInterval(web3_factory_status,15000); setInterval(web3_factory_status,60000); } } catch(e) { err = web3_error_parse(e); x = document.getElementById('modal_txs_info_err'); x.innerHTML = err; x = document.getElementById('modal_txs_info_btn'); x.innerHTML = 'Transaction error'; console.log(t); } } async function web3_circle_distribute_node(circle) { var gas; var cost; var tarif; var tarif_name; var t; var x; var net = "bsc"; var amount; x = document.getElementById("modal_circle_cost"); amount = x.innerHTML; x = document.getElementById("modal_circle_c_addr"); var c = x.innerHTML; var debug = 0; if(!selectedAccount)return false; const signer2 = await get_signer2(); var wal = selectedAccount; if(!wal) return false; x = document.getElementById("modal_circle_cost"); cost = x.innerHTML; x = document.getElementById("modal_circle_tarif_id"); tarif = x.innerHTML; x = document.getElementById("modal_circle_tarif_name"); tarif_name = x.innerHTML; const contract = new ethers.Contract(c, eth_abi["distribute_nodes"], signer2); name = "Distribute "+amount+" USDT for node processing"; console.log("Contract: "+c); console.log("tarif: "+tarif); console.log("Circle: "+circle); console.log("Cost: "+cost); console.log("Debug: "+debug); modal_tx_info_open(name); try { data = contract.interface.encodeFunctionData('Process', [tarif,circle,debug]); console.log("Data: "+data); var options = {}; console.log(options); console.log("before Gas"); gas = await contract.estimateGas.Process(tarif,circle,debug,options); console.log("after Gas"); console.log("Gas: "+gas); options = {gasLimit: Math.ceil(gas*1.2)}; r = await contract.Process(tarif,circle,debug,options); if(r) { x = document.getElementById('modal_txs_info_id'); x.innerHTML = r.hash; console.log(r); x = document.getElementById('modal_txs_info_btn'); x.innerHTML = 'View in Explorer'; x.disabled = 0; setTimeout(web3_factory_status,15000); } } catch(e) { err = web3_error_parse(e); x = document.getElementById('modal_txs_info_err'); x.innerHTML = err; x = document.getElementById('modal_txs_info_btn'); x.innerHTML = 'Transaction error'; console.log(t); } } glob["abi"] = [ "function claim(uint8 round)external", "function approve(address spender, uint256 amount) external returns (bool)", ]; glob["abi_ref_register"] = [ "function NickRegister(string memory name) external payable returns(bool)", ]; glob["abi_ref_balance"] = [ "function Balance(address addr)external view returns(uint256)", ] 